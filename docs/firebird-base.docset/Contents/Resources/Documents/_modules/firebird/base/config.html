<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>firebird.base.config &#8212; Firebird-base 1.4.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/bootstrap-sphinx.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <link rel="shortcut icon" href="../../../_static/fb-favicon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../../../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../../../_static/bootstrap-2.3.2/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>

        <a class="brand" href="../../../index.html">
          Firebird-base</a>
        <span class="navbar-text pull-left"><b>1.4.2</b></span>

        <div class="nav-collapse">
          <ul class="nav">
            <li class="divider-vertical"></li>
            
                <li><a href="../../../introduction.html">Introduction</a></li>
                <li><a href="../../../modules.html">Modules</a></li>
                <li><a href="../../../genindex.html">Index</a></li>
                <li><a href="../../../changelog.html">Changelog</a></li>
                <li><a href="../../../license.html">License</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"></ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
      </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body span12 content" role="main">
      
  <h1>Source code for firebird.base.config</h1><div class="highlight"><pre>
<span></span><span class="c1">#coding:utf-8</span>
<span class="c1">#</span>
<span class="c1"># PROGRAM/MODULE: firebird-base</span>
<span class="c1"># FILE:           firebird/base/config.py</span>
<span class="c1"># DESCRIPTION:    Classes for configuration definitions</span>
<span class="c1"># CREATED:        14.5.2020</span>
<span class="c1">#</span>
<span class="c1"># The contents of this file are subject to the MIT License</span>
<span class="c1">#</span>
<span class="c1"># Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="c1"># of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="c1"># in the Software without restriction, including without limitation the rights</span>
<span class="c1"># to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span>
<span class="c1"># copies of the Software, and to permit persons to whom the Software is</span>
<span class="c1"># furnished to do so, subject to the following conditions:</span>
<span class="c1">#</span>
<span class="c1"># The above copyright notice and this permission notice shall be included in all</span>
<span class="c1"># copies or substantial portions of the Software.</span>
<span class="c1">#</span>
<span class="c1"># THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="c1"># IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="c1"># FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
<span class="c1"># AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
<span class="c1"># LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
<span class="c1"># OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span>
<span class="c1"># SOFTWARE.</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2019 Firebird Project (www.firebirdsql.org)</span>
<span class="c1"># All Rights Reserved.</span>
<span class="c1">#</span>
<span class="c1"># Contributor(s): Pavel Císař (original code)</span>
<span class="c1">#                 ______________________________________.</span>

<span class="sd">&quot;&quot;&quot;Firebird Base - Classes for configuration definitions</span>

<span class="sd">Complex applications (and some library modules like `logging`) could be often parametrized</span>
<span class="sd">via configuration. This module provides a framework for unified structured configuration</span>
<span class="sd">that supports:</span>

<span class="sd">* configuration options of various data type, including lists and other complex types</span>
<span class="sd">* validation</span>
<span class="sd">* direct manipulation of configuration values</span>
<span class="sd">* reading from (and writing into) configuration in `configparser` format</span>
<span class="sd">* exchanging configuration (for example between processes) using Google protobuf messages</span>
<span class="sd">* application directory scheme</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Generic</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> \
     <span class="n">TypeVar</span><span class="p">,</span> <span class="n">cast</span><span class="p">,</span> <span class="n">get_type_hints</span>
<span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">uuid</span> <span class="kn">import</span> <span class="n">UUID</span>
<span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span><span class="p">,</span> <span class="n">DecimalException</span>
<span class="kn">from</span> <span class="nn">configparser</span> <span class="kn">import</span> <span class="n">ConfigParser</span><span class="p">,</span> <span class="n">DEFAULTSECT</span>
<span class="kn">from</span> <span class="nn">inspect</span> <span class="kn">import</span> <span class="n">signature</span><span class="p">,</span> <span class="n">Signature</span><span class="p">,</span> <span class="n">Parameter</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span><span class="p">,</span> <span class="n">Flag</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">.config_pb2</span> <span class="kn">import</span> <span class="n">ConfigProto</span>
<span class="kn">from</span> <span class="nn">.types</span> <span class="kn">import</span> <span class="n">Error</span><span class="p">,</span> <span class="n">MIME</span><span class="p">,</span> <span class="n">ZMQAddress</span><span class="p">,</span> <span class="n">PyExpr</span><span class="p">,</span> <span class="n">PyCode</span><span class="p">,</span> <span class="n">PyCallable</span><span class="p">,</span> <span class="n">_decompose</span>
<span class="kn">from</span> <span class="nn">.strconv</span> <span class="kn">import</span> <span class="n">get_convertor</span><span class="p">,</span> <span class="n">convert_to_str</span><span class="p">,</span> <span class="n">Convertor</span>

<span class="n">PROTO_CONFIG</span> <span class="o">=</span> <span class="s1">&#39;firebird.base.ConfigProto&#39;</span>

<span class="k">def</span> <span class="nf">unindent_verticals</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Removes trailing &#39;|&#39; character from each line in multiline string.&quot;&quot;&quot;</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">indent</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">indent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">indent</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()))</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">indent</span><span class="p">:])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_eq</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

<div class="viewcode-block" id="create_config"><a class="viewcode-back" href="../../../config.html#firebird.base.config.create_config">[docs]</a><span class="k">def</span> <span class="nf">create_config</span><span class="p">(</span><span class="n">_cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">Config</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Config</span><span class="p">:</span> <span class="c1"># pragma: no cover</span>
    <span class="sd">&quot;&quot;&quot;Return newly created `Config` instance. Intended to be used with `functools.partial`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_cls</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>


<div class="viewcode-block" id="DirectoryScheme"><a class="viewcode-back" href="../../../config.html#firebird.base.config.DirectoryScheme">[docs]</a><span class="k">class</span> <span class="nc">DirectoryScheme</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Class that provide paths to typically used application directories.</span>

<span class="sd">    Default scheme uses HOME directory as root for other directories. The HOME is</span>
<span class="sd">    determined as follows:</span>

<span class="sd">    1. If environment variable `&lt;app_name&gt;_HOME` exists, its value is used as HOME directory.</span>
<span class="sd">    2. HOME directory is set to current working directory.</span>

<span class="sd">    Note:</span>
<span class="sd">        All paths are set when the instance is created and can be changed later.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="DirectoryScheme.__init__"><a class="viewcode-back" href="../../../config.html#firebird.base.config.DirectoryScheme.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">force_home</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arguments:</span>
<span class="sd">            name: Appplication name.</span>
<span class="sd">            version: Application version.</span>
<span class="sd">            force_home: When True, general directories (i.e. all except user-specific and</span>
<span class="sd">                TMP) would be always based on HOME directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">version</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">force_home</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">force_home</span>
        <span class="n">_h</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s1">_HOME&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__home</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">_h</span><span class="p">)</span> <span class="k">if</span> <span class="n">_h</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
        <span class="n">home</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">home</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;config&#39;</span><span class="p">:</span> <span class="n">home</span> <span class="o">/</span> <span class="s1">&#39;config&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;run_data&#39;</span><span class="p">:</span> <span class="n">home</span> <span class="o">/</span> <span class="s1">&#39;run_data&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;logs&#39;</span><span class="p">:</span> <span class="n">home</span> <span class="o">/</span> <span class="s1">&#39;logs&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">home</span> <span class="o">/</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;tmp&#39;</span><span class="p">:</span> <span class="n">home</span> <span class="o">/</span> <span class="s1">&#39;tmp&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;cache&#39;</span><span class="p">:</span> <span class="n">home</span> <span class="o">/</span> <span class="s1">&#39;cache&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;srv&#39;</span><span class="p">:</span> <span class="n">home</span> <span class="o">/</span> <span class="s1">&#39;srv&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;user_config&#39;</span><span class="p">:</span> <span class="n">home</span> <span class="o">/</span> <span class="s1">&#39;user_config&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;user_data&#39;</span><span class="p">:</span> <span class="n">home</span> <span class="o">/</span> <span class="s1">&#39;user_data&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;user_sync&#39;</span><span class="p">:</span> <span class="n">home</span> <span class="o">/</span> <span class="s1">&#39;user_sync&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;user_cache&#39;</span><span class="p">:</span> <span class="n">home</span> <span class="o">/</span> <span class="s1">&#39;user_cache&#39;</span><span class="p">,</span>
                                      <span class="p">}</span></div>
<div class="viewcode-block" id="DirectoryScheme.has_home_env"><a class="viewcode-back" href="../../../config.html#firebird.base.config.DirectoryScheme.has_home_env">[docs]</a>    <span class="k">def</span> <span class="nf">has_home_env</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns True if HOME directory is set by &quot;&lt;app_name&gt;_HOME&quot; environment variable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s1">_HOME&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span></div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">home</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;HOME directory. Initial value is path set by `&lt;app_name&gt;_HOME` environment</span>
<span class="sd">        variable, or to current working directory when variable is not defined.</span>

<span class="sd">        Important:</span>
<span class="sd">            When new value is assigned, the general directories (i.e. all except user-specific</span>
<span class="sd">            and TMP) are redefined as subdirectories of new home path ONLY when HOME was</span>
<span class="sd">            initially defined using `&lt;app_name&gt;_HOME` environment variable, or instance</span>
<span class="sd">            was created with `force_home` = True.</span>

<span class="sd">            However, all paths could be still changed individually to any value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__home</span>
    <span class="nd">@home</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">home</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__home</span> <span class="o">=</span> <span class="n">value</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Path</span><span class="p">)</span> <span class="k">else</span> <span class="n">Path</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_home_env</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">force_home</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;config&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__home</span> <span class="o">/</span> <span class="s1">&#39;config&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;run_data&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__home</span> <span class="o">/</span> <span class="s1">&#39;run_data&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;logs&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__home</span> <span class="o">/</span> <span class="s1">&#39;logs&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__home</span> <span class="o">/</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;cache&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__home</span> <span class="o">/</span> <span class="s1">&#39;cache&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;srv&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__home</span> <span class="o">/</span> <span class="s1">&#39;srv&#39;</span><span class="p">})</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Directory for host-specific system-wide configuration files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="p">[</span><span class="s1">&#39;config&#39;</span><span class="p">]</span>
    <span class="nd">@config</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="p">[</span><span class="s1">&#39;config&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">run_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Directory for run-time variable data that may not persist over boot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="p">[</span><span class="s1">&#39;run_data&#39;</span><span class="p">]</span>
    <span class="nd">@run_data</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">run_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="p">[</span><span class="s1">&#39;run_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">logs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Directory for log files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="p">[</span><span class="s1">&#39;logs&#39;</span><span class="p">]</span>
    <span class="nd">@logs</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">logs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="p">[</span><span class="s1">&#39;logs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Directory for state information / persistent data modified by application as</span>
<span class="sd">        it runs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
    <span class="nd">@data</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">tmp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Directory for temporary files to be preserved between reboots.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="p">[</span><span class="s1">&#39;tmp&#39;</span><span class="p">]</span>
    <span class="nd">@tmp</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">tmp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="p">[</span><span class="s1">&#39;tmp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Directory for application cache data.</span>

<span class="sd">        Such data are locally generated as a result of time-consuming I/O or calculation.</span>
<span class="sd">        The application must be able to regenerate or restore the data. The cached files</span>
<span class="sd">        can be deleted without loss of data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="p">[</span><span class="s1">&#39;cache&#39;</span><span class="p">]</span>
    <span class="nd">@cache</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">cache</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="p">[</span><span class="s1">&#39;cache&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">srv</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Directory for site-specific data served by this system, such as data and</span>
<span class="sd">        scripts for web servers, data offered by FTP servers, and repositories for</span>
<span class="sd">        version control systems etc.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="p">[</span><span class="s1">&#39;srv&#39;</span><span class="p">]</span>
    <span class="nd">@srv</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">srv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="p">[</span><span class="s1">&#39;srv&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">user_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Directory for user-specific configuration.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="p">[</span><span class="s1">&#39;user_config&#39;</span><span class="p">]</span>
    <span class="nd">@user_config</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">user_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="p">[</span><span class="s1">&#39;user_config&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">user_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Directory for User local data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="p">[</span><span class="s1">&#39;user_data&#39;</span><span class="p">]</span>
    <span class="nd">@user_data</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">user_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="p">[</span><span class="s1">&#39;user_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">user_sync</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Directory for user data synced accross systems (roaming).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="p">[</span><span class="s1">&#39;user_sync&#39;</span><span class="p">]</span>
    <span class="nd">@user_sync</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">user_sync</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="p">[</span><span class="s1">&#39;user_sync&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">user_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Directory for user-specific application cache data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="p">[</span><span class="s1">&#39;user_cache&#39;</span><span class="p">]</span>
    <span class="nd">@user_cache</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">user_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="p">[</span><span class="s1">&#39;user_cache&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span></div>


<div class="viewcode-block" id="WindowsDirectoryScheme"><a class="viewcode-back" href="../../../config.html#firebird.base.config.WindowsDirectoryScheme">[docs]</a><span class="k">class</span> <span class="nc">WindowsDirectoryScheme</span><span class="p">(</span><span class="n">DirectoryScheme</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Directory scheme that conforms to Windows standards.</span>

<span class="sd">    If HOME is defined using &quot;&lt;app_name&gt;_HOME&quot; environment variable, or `force_home` parameter</span>
<span class="sd">    is True, only user-specific directories and TMP are set according to platform standars,</span>
<span class="sd">    while general directories remain as defined by base `DirectoryScheme`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="WindowsDirectoryScheme.__init__"><a class="viewcode-back" href="../../../config.html#firebird.base.config.WindowsDirectoryScheme.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">force_home</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arguments:</span>
<span class="sd">            name: Appplication name.</span>
<span class="sd">            version: Application version.</span>
<span class="sd">            force_home: When True, general directories (i.e. all except user-specific and</span>
<span class="sd">                TMP) would be always based on HOME directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">version</span><span class="p">,</span> <span class="n">force_home</span><span class="p">)</span>
        <span class="n">app_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">app_dir</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span>
        <span class="n">pd</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expandvars</span><span class="p">(</span><span class="s1">&#39;%PROGRAMDATA%&#39;</span><span class="p">))</span>
        <span class="n">lad</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expandvars</span><span class="p">(</span><span class="s1">&#39;%LOCALAPPDATA%&#39;</span><span class="p">))</span>
        <span class="n">ad</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expandvars</span><span class="p">(</span><span class="s1">&#39;%APPDATA%&#39;</span><span class="p">))</span>
        <span class="c1"># Set general directories only when HOME is not forced by environment variable.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_home_env</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">force_home</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;config&#39;</span><span class="p">:</span> <span class="n">pd</span> <span class="o">/</span> <span class="n">app_dir</span> <span class="o">/</span> <span class="s1">&#39;config&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;run_data&#39;</span><span class="p">:</span> <span class="n">pd</span> <span class="o">/</span> <span class="n">app_dir</span> <span class="o">/</span> <span class="s1">&#39;run&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;logs&#39;</span><span class="p">:</span> <span class="n">pd</span> <span class="o">/</span> <span class="n">app_dir</span> <span class="o">/</span> <span class="s1">&#39;log&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">pd</span> <span class="o">/</span> <span class="n">app_dir</span> <span class="o">/</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;cache&#39;</span><span class="p">:</span> <span class="n">pd</span> <span class="o">/</span> <span class="n">app_dir</span> <span class="o">/</span> <span class="s1">&#39;cache&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;srv&#39;</span><span class="p">:</span> <span class="n">pd</span> <span class="o">/</span> <span class="n">app_dir</span> <span class="o">/</span> <span class="s1">&#39;srv&#39;</span><span class="p">,</span>
                                 <span class="p">})</span>
        <span class="c1"># Always set user-specific directories and TMP</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;tmp&#39;</span><span class="p">:</span> <span class="n">lad</span> <span class="o">/</span> <span class="n">app_dir</span> <span class="o">/</span> <span class="s1">&#39;tmp&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;user_config&#39;</span><span class="p">:</span> <span class="n">lad</span> <span class="o">/</span> <span class="n">app_dir</span> <span class="o">/</span> <span class="s1">&#39;config&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;user_data&#39;</span><span class="p">:</span> <span class="n">lad</span> <span class="o">/</span> <span class="n">app_dir</span> <span class="o">/</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;user_sync&#39;</span><span class="p">:</span> <span class="n">ad</span> <span class="o">/</span> <span class="n">app_dir</span><span class="p">,</span>
                             <span class="s1">&#39;user_cache&#39;</span><span class="p">:</span> <span class="n">lad</span> <span class="o">/</span> <span class="n">app_dir</span> <span class="o">/</span> <span class="s1">&#39;cache&#39;</span><span class="p">,</span>
                             <span class="p">})</span></div></div>

<div class="viewcode-block" id="LinuxDirectoryScheme"><a class="viewcode-back" href="../../../config.html#firebird.base.config.LinuxDirectoryScheme">[docs]</a><span class="k">class</span> <span class="nc">LinuxDirectoryScheme</span><span class="p">(</span><span class="n">DirectoryScheme</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Directory scheme that conforms to Linux standards.</span>

<span class="sd">    If HOME is defined using &quot;&lt;app_name&gt;_HOME&quot; environment variable, or `force_home` parameter</span>
<span class="sd">    is True, only user-specific directories and TMP are set according to platform standars,</span>
<span class="sd">    while general directories remain as defined by base `DirectoryScheme`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="LinuxDirectoryScheme.__init__"><a class="viewcode-back" href="../../../config.html#firebird.base.config.LinuxDirectoryScheme.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">force_home</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arguments:</span>
<span class="sd">            name: Appplication name.</span>
<span class="sd">            version: Application version.</span>
<span class="sd">            force_home: When True, general directories (i.e. all except user-specific and</span>
<span class="sd">                TMP) would be always based on HOME directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">version</span><span class="p">,</span> <span class="n">force_home</span><span class="p">)</span>
        <span class="n">app_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">app_dir</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span>
        <span class="c1"># Set general directories only when HOME is not forced by environment variable.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_home_env</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">force_home</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;config&#39;</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;/etc&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">app_dir</span><span class="p">,</span>
                                 <span class="s1">&#39;run_data&#39;</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;/run&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">app_dir</span><span class="p">,</span>
                                 <span class="s1">&#39;logs&#39;</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;/var/log&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">app_dir</span><span class="p">,</span>
                                 <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;/var/lib&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">app_dir</span><span class="p">,</span>
                                 <span class="s1">&#39;cache&#39;</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;/var/cache&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">app_dir</span><span class="p">,</span>
                                 <span class="s1">&#39;srv&#39;</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;/srv&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">app_dir</span><span class="p">,</span>
                                 <span class="p">})</span>
        <span class="c1"># Always set user-specific directories and TMP</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;tmp&#39;</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;/var/tmp&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">app_dir</span><span class="p">,</span>
                             <span class="s1">&#39;user_config&#39;</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;~/.config&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span> <span class="o">/</span> <span class="n">app_dir</span><span class="p">,</span>
                             <span class="s1">&#39;user_data&#39;</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;~/.local/share&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span> <span class="o">/</span> <span class="n">app_dir</span><span class="p">,</span>
                             <span class="s1">&#39;user_sync&#39;</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;~/.local/sync&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span> <span class="o">/</span> <span class="n">app_dir</span><span class="p">,</span>
                             <span class="s1">&#39;user_cache&#39;</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;~/.cache&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span> <span class="o">/</span> <span class="n">app_dir</span><span class="p">,</span>
                             <span class="p">})</span></div></div>

<div class="viewcode-block" id="MacOSDirectoryScheme"><a class="viewcode-back" href="../../../config.html#firebird.base.config.MacOSDirectoryScheme">[docs]</a><span class="k">class</span> <span class="nc">MacOSDirectoryScheme</span><span class="p">(</span><span class="n">DirectoryScheme</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Directory scheme that conforms to MacOS standards.</span>

<span class="sd">    If HOME is defined using &quot;&lt;app_name&gt;_HOME&quot; environment variable, only user-specific</span>
<span class="sd">    directories and TMP are set according to platform standars, while general directories</span>
<span class="sd">    remain as defined by base `DirectoryScheme`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="MacOSDirectoryScheme.__init__"><a class="viewcode-back" href="../../../config.html#firebird.base.config.MacOSDirectoryScheme.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">force_home</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arguments:</span>
<span class="sd">            name: Appplication name.</span>
<span class="sd">            version: Application version.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">version</span><span class="p">,</span> <span class="n">force_home</span><span class="p">)</span>
        <span class="n">app_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">app_dir</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span>
        <span class="n">pd</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;/Library/Application Support&#39;</span><span class="p">)</span>
        <span class="n">lad</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;~/Library/Application Support&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>
        <span class="c1"># Set general directories only when HOME is not forced by environment variable.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_home_env</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">force_home</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;config&#39;</span><span class="p">:</span> <span class="n">pd</span> <span class="o">/</span> <span class="n">app_dir</span> <span class="o">/</span> <span class="s1">&#39;config&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;run_data&#39;</span><span class="p">:</span> <span class="n">pd</span> <span class="o">/</span> <span class="n">app_dir</span> <span class="o">/</span> <span class="s1">&#39;run&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;logs&#39;</span><span class="p">:</span> <span class="n">pd</span> <span class="o">/</span> <span class="n">app_dir</span> <span class="o">/</span> <span class="s1">&#39;log&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">pd</span> <span class="o">/</span> <span class="n">app_dir</span> <span class="o">/</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;cache&#39;</span><span class="p">:</span> <span class="n">pd</span> <span class="o">/</span> <span class="n">app_dir</span> <span class="o">/</span> <span class="s1">&#39;cache&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;srv&#39;</span><span class="p">:</span> <span class="n">pd</span> <span class="o">/</span> <span class="n">app_dir</span> <span class="o">/</span> <span class="s1">&#39;srv&#39;</span><span class="p">,</span>
                                 <span class="p">})</span>
        <span class="c1"># Always set user-specific directories and TMP</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dir_map</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;tmp&#39;</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;TMPDIR&#39;</span><span class="p">))</span> <span class="o">/</span> <span class="n">app_dir</span><span class="p">,</span>
                             <span class="s1">&#39;user_config&#39;</span><span class="p">:</span> <span class="n">lad</span> <span class="o">/</span> <span class="n">app_dir</span> <span class="o">/</span> <span class="s1">&#39;config&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;user_data&#39;</span><span class="p">:</span> <span class="n">lad</span> <span class="o">/</span> <span class="n">app_dir</span> <span class="o">/</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;user_sync&#39;</span><span class="p">:</span> <span class="n">lad</span> <span class="o">/</span> <span class="n">app_dir</span><span class="p">,</span>
                             <span class="s1">&#39;user_cache&#39;</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;~/Library/Caches&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span> <span class="o">/</span> <span class="n">app_dir</span> <span class="o">/</span> <span class="s1">&#39;cache&#39;</span><span class="p">,</span>
                             <span class="p">})</span></div></div>

<div class="viewcode-block" id="get_directory_scheme"><a class="viewcode-back" href="../../../config.html#firebird.base.config.get_directory_scheme">[docs]</a><span class="k">def</span> <span class="nf">get_directory_scheme</span><span class="p">(</span><span class="n">app_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">force_home</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DirectoryScheme</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns directory scheme for current platform.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        app_name: Application name</span>
<span class="sd">        version: Application version string</span>
<span class="sd">        force_home: When True, the general directies are always set to subdirectories of</span>
<span class="sd">                    `DirectoryScheme.home` directory. When False, these the home is used</span>
<span class="sd">                    ONLY when it&#39;s set by &quot;&lt;app_name&gt;_HOME&quot; environment variable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;Windows&#39;</span><span class="p">:</span> <span class="n">WindowsDirectoryScheme</span><span class="p">,</span>
            <span class="s1">&#39;Linux&#39;</span><span class="p">:</span><span class="n">LinuxDirectoryScheme</span><span class="p">,</span>
            <span class="s1">&#39;Darwin&#39;</span><span class="p">:</span> <span class="n">MacOSDirectoryScheme</span><span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">(),</span> <span class="n">DirectoryScheme</span><span class="p">)(</span><span class="n">app_name</span><span class="p">,</span> <span class="n">version</span><span class="p">,</span> <span class="n">force_home</span><span class="p">)</span></div>

<span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Option"><a class="viewcode-back" href="../../../config.html#firebird.base.config.Option">[docs]</a><span class="k">class</span> <span class="nc">Option</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generic abstract base class for configuration options.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="Option.__init__"><a class="viewcode-back" href="../../../config.html#firebird.base.config.Option.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">datatype</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">default</span><span class="p">:</span> <span class="n">T</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arguments:</span>
<span class="sd">            name: Option name.</span>
<span class="sd">            datatype: Option datatype.</span>
<span class="sd">            description: Option description. Can span multiple lines.</span>
<span class="sd">            required: True if option must have a value.</span>
<span class="sd">            default: Default option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">name</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s2">&quot;name required&quot;</span>
        <span class="k">assert</span> <span class="n">datatype</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">datatype</span><span class="p">,</span> <span class="nb">type</span><span class="p">),</span> <span class="s2">&quot;datatype required&quot;</span>
        <span class="k">assert</span> <span class="n">description</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">description</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s2">&quot;description required&quot;</span>
        <span class="k">assert</span> <span class="n">default</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">default</span><span class="p">,</span> <span class="n">datatype</span><span class="p">),</span> <span class="s2">&quot;default has wrong data type&quot;</span>
        <span class="c1">#: Option name.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">name</span>
        <span class="c1">#: Option datatype.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">datatype</span><span class="p">:</span> <span class="n">T</span> <span class="o">=</span> <span class="n">datatype</span>
        <span class="c1">#: Option description. Can span multiple lines.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">description</span>
        <span class="c1">#: True if option must have a value.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">required</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">required</span>
        <span class="c1">#: Default option value.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">:</span> <span class="n">T</span> <span class="o">=</span> <span class="n">default</span>
        <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">default</span><span class="p">)</span></div>
    <span class="k">def</span> <span class="nf">_check_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">required</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Value is required for option &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">datatype</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Option &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; value must be a &quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">datatype</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;,&quot;</span>
                            <span class="sa">f</span><span class="s2">&quot; not &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_get_value_description</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">datatype</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
<div class="viewcode-block" id="Option._get_config_lines"><a class="viewcode-back" href="../../../config.html#firebird.base.config.Option._get_config_lines">[docs]</a>    <span class="k">def</span> <span class="nf">_get_config_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Returns list of strings containing text lines suitable for use in configuration</span>
<span class="sd">        file processed with `~configparser.ConfigParser`.</span>

<span class="sd">        Text lines with configuration start with comment marker `;` and end with newline.</span>

<span class="sd">        Note:</span>
<span class="sd">           This function is intended for internal use. To get string describing current</span>
<span class="sd">           configuration that is suitable for configuration files, use `get_config` method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hdr</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">datatype</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">][</span><span class="si">{</span><span class="s1">&#39;REQUIRED&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">required</span> <span class="k">else</span> <span class="s1">&#39;optional&#39;</span><span class="si">}</span><span class="s2">]&quot;</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">required</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;; REQUIRED option.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;; </span><span class="si">{</span><span class="n">line</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">first</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_value_description</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;; </span><span class="si">{</span><span class="s1">&#39;Type: &#39;</span> <span class="k">if</span> <span class="n">first</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="si">}{</span><span class="n">line</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">first</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span>
        <span class="n">nodef</span> <span class="o">=</span> <span class="s1">&#39;;&#39;</span> <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;&lt;UNDEFINED&gt;&#39;</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_formatted</span><span class="p">()</span>
        <span class="k">if</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="n">chunks</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">splitlines</span><span class="p">(</span><span class="n">keepends</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">new_value</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunks</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">new_value</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">nodef</span><span class="si">}{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">chunks</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
            <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">new_value</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">nodef</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lines</span></div>
<div class="viewcode-block" id="Option.load_config"><a class="viewcode-back" href="../../../config.html#firebird.base.config.Option.load_config">[docs]</a>    <span class="k">def</span> <span class="nf">load_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">ConfigParser</span><span class="p">,</span> <span class="n">section</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Update option value from `~configparser.ConfigParser` instance.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            config:  ConfigParser instance.</span>
<span class="sd">            section: Name of ConfigParser section that should be used to get new option</span>
<span class="sd">               value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: When option value cannot be loadded.</span>
<span class="sd">            KeyError: If section does not exists, and it&#39;s not `configparser.DEFAULTSECT`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">config</span><span class="o">.</span><span class="n">has_section</span><span class="p">(</span><span class="n">section</span><span class="p">)</span> <span class="ow">and</span> <span class="n">section</span> <span class="o">!=</span> <span class="n">DEFAULTSECT</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Configuration error: section &#39;</span><span class="si">{</span><span class="n">section</span><span class="si">}</span><span class="s2">&#39; not found!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="n">section</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_as_str</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="n">section</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">])</span></div>
<div class="viewcode-block" id="Option.validate"><a class="viewcode-back" href="../../../config.html#firebird.base.config.Option.validate">[docs]</a>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Validates option state.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Error: When required option does not have a value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">required</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing value for required option &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="Option.get_config"><a class="viewcode-back" href="../../../config.html#firebird.base.config.Option.get_config">[docs]</a>    <span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns string containing text lines suitable for use in configuration file</span>
<span class="sd">        processed with `~configparser.ConfigParser`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_config_lines</span><span class="p">())</span></div>
<div class="viewcode-block" id="Option.has_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.Option.has_value">[docs]</a>    <span class="k">def</span> <span class="nf">has_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns True if option value is not None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="Option.clear"><a class="viewcode-back" href="../../../config.html#firebird.base.config.Option.clear">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">to_default</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clears the option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            to_default: If True, sets the option value to default value, else to None.</span>
<span class="sd">        &quot;&quot;&quot;</span></div>
<div class="viewcode-block" id="Option.get_formatted"><a class="viewcode-back" href="../../../config.html#firebird.base.config.Option.get_formatted">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_formatted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value formatted for use in config file.</span>
<span class="sd">        &quot;&quot;&quot;</span></div>
<div class="viewcode-block" id="Option.set_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.Option.set_as_str">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">set_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value from string.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span></div>
<div class="viewcode-block" id="Option.get_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.Option.get_as_str">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value as string.</span>
<span class="sd">        &quot;&quot;&quot;</span></div>
<div class="viewcode-block" id="Option.get_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.Option.get_value">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns current option value.</span>
<span class="sd">        &quot;&quot;&quot;</span></div>
<div class="viewcode-block" id="Option.set_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.Option.set_value">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span></div>
<div class="viewcode-block" id="Option.load_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.Option.load_proto">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">load_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Deserialize value from `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message that may contains options value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span></div>
<div class="viewcode-block" id="Option.save_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.Option.save_proto">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">save_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Serialize value into `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message where option value should be stored.</span>
<span class="sd">        &quot;&quot;&quot;</span></div></div>

<div class="viewcode-block" id="Config"><a class="viewcode-back" href="../../../config.html#firebird.base.config.Config">[docs]</a><span class="k">class</span> <span class="nc">Config</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Collection of configuration options.</span>

<span class="sd">    Important:</span>
<span class="sd">        Descendants must define individual options and sub configs as instance attributes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="Config.__init__"><a class="viewcode-back" href="../../../config.html#firebird.base.config.Config.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">optional</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arguments:</span>
<span class="sd">            name: Name associated with Config (default section name).</span>
<span class="sd">            optional: Whether config is optional (False) or mandatory (True) for</span>
<span class="sd">                      configuration file (see `.load_config()` for details).</span>
<span class="sd">            description: Optional configuration description. Can span multiple lines.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_optional</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">optional</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">description</span> <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__doc__</span></div>
    <span class="k">def</span> <span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">Option</span><span class="p">)</span> <span class="ow">and</span> <span class="n">attr</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Cannot assign values to option itself, use `option.value` instead&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<div class="viewcode-block" id="Config.validate"><a class="viewcode-back" href="../../../config.html#firebird.base.config.Config.validate">[docs]</a>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Checks whether:</span>
<span class="sd">            - all required options have value other than None.</span>
<span class="sd">            - all options are defined as config attribute with the same name as option name</span>

<span class="sd">        Raises exception when any constraint required by configuration is violated.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">option</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Option &#39;</span><span class="si">{</span><span class="n">option</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; is not defined as &quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;attribute with the same name&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="Config.clear"><a class="viewcode-back" href="../../../config.html#firebird.base.config.Config.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">to_default</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clears all owned options and options in owned sub-configs.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            to_default: If True, sets the option values to defaults, else to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">option</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">to_default</span><span class="o">=</span><span class="n">to_default</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">config</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">configs</span><span class="p">:</span>
            <span class="n">config</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">to_default</span><span class="o">=</span><span class="n">to_default</span><span class="p">)</span></div>
<div class="viewcode-block" id="Config.get_description"><a class="viewcode-back" href="../../../config.html#firebird.base.config.Config.get_description">[docs]</a>    <span class="k">def</span> <span class="nf">get_description</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Configuration description. Can span multiple lines.</span>

<span class="sd">        Note:  If description is not provided on instance creation, class doc string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_description</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_description</span></div>
<div class="viewcode-block" id="Config.get_config"><a class="viewcode-back" href="../../../config.html#firebird.base.config.Config.get_config">[docs]</a>    <span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns string containing text lines suitable for use in configuration file</span>
<span class="sd">        processed with `~configparser.ConfigParser`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;[</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">]</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_description</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;; </span><span class="si">{</span><span class="n">line</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">get_config</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">config</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">configs</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get_config</span><span class="p">())</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span></div>
<div class="viewcode-block" id="Config.load_config"><a class="viewcode-back" href="../../../config.html#firebird.base.config.Config.load_config">[docs]</a>    <span class="k">def</span> <span class="nf">load_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">ConfigParser</span><span class="p">,</span> <span class="n">section</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Update configuration.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            config:  ConfigParser instance with configuration values.</span>
<span class="sd">            section: Name of ConfigParser section that should be used to get new</span>
<span class="sd">                     configuration values. If not provided, uses `name`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: When any option value cannot be loadded.</span>
<span class="sd">            KeyError: If section does not exists, and config is not `optional` or section is</span>
<span class="sd">                      not `configparser.DEFAULTSECT`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">section</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">section</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">config</span><span class="o">.</span><span class="n">has_section</span><span class="p">(</span><span class="n">section</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_optional</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">section</span> <span class="o">!=</span> <span class="n">DEFAULTSECT</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Configuration error: section &#39;</span><span class="si">{</span><span class="n">section</span><span class="si">}</span><span class="s2">&#39; not found!&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
                <span class="n">option</span><span class="o">.</span><span class="n">load_config</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">section</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">subcfg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">configs</span><span class="p">:</span>
                <span class="n">subcfg</span><span class="o">.</span><span class="n">load_config</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">Error</span><span class="p">:</span>
            <span class="k">raise</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span> <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Configuration error: </span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">exc</span></div>
<div class="viewcode-block" id="Config.load_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.Config.load_proto">[docs]</a>    <span class="k">def</span> <span class="nf">load_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Deserialize value from `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message that may contains option values and sub-configs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">option</span><span class="o">.</span><span class="n">load_proto</span><span class="p">(</span><span class="n">proto</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">subcfg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">configs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">subcfg</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">proto</span><span class="o">.</span><span class="n">configs</span><span class="p">:</span>
                <span class="n">subcfg</span><span class="o">.</span><span class="n">load_proto</span><span class="p">(</span><span class="n">proto</span><span class="o">.</span><span class="n">configs</span><span class="p">[</span><span class="n">subcfg</span><span class="o">.</span><span class="n">name</span><span class="p">])</span></div>
<div class="viewcode-block" id="Config.save_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.Config.save_proto">[docs]</a>    <span class="k">def</span> <span class="nf">save_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Serialize value into `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message where option values and sub-configs should be stored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">option</span><span class="o">.</span><span class="n">save_proto</span><span class="p">(</span><span class="n">proto</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">subcfg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">configs</span><span class="p">:</span>
            <span class="n">subcfg</span><span class="o">.</span><span class="n">save_proto</span><span class="p">(</span><span class="n">proto</span><span class="o">.</span><span class="n">configs</span><span class="o">.</span><span class="n">get_or_create</span><span class="p">(</span><span class="n">subcfg</span><span class="o">.</span><span class="n">name</span><span class="p">))</span></div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Name associated with Config (default section name).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">optional</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether config is optional (False) or mandatory (True) for configuration file</span>
<span class="sd">        (see `.load_config()` for details).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_optional</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">options</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Option</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;List of options defined for this Config instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Option</span><span class="p">)]</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">configs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Config</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;List of sub-Configs defined for this Config instance. It includes all instance</span>
<span class="sd">        attributes of `Config` type, and `Config` values of owned `ConfigOption` and</span>
<span class="sd">        `ConfigListOption` instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Config</span><span class="p">)</span> <span class="k">else</span> <span class="n">v</span><span class="o">.</span><span class="n">value</span>
                  <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="n">Config</span><span class="p">,</span> <span class="n">ConfigOption</span><span class="p">))]</span>
        <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="p">(</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">ConfigListOption</span><span class="p">)):</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<span class="c1"># Options</span>
<div class="viewcode-block" id="StrOption"><a class="viewcode-back" href="../../../config.html#firebird.base.config.StrOption">[docs]</a><span class="k">class</span> <span class="nc">StrOption</span><span class="p">(</span><span class="n">Option</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Configuration option with string value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="StrOption.__init__"><a class="viewcode-back" href="../../../config.html#firebird.base.config.StrOption.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">required</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arguments:</span>
<span class="sd">            name: Option name.</span>
<span class="sd">            description: Option description. Can span multiple lines.</span>
<span class="sd">            required: True if option must have a value.</span>
<span class="sd">            default: Default option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">required</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span></div>
<div class="viewcode-block" id="StrOption.clear"><a class="viewcode-back" href="../../../config.html#firebird.base.config.StrOption.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">to_default</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clears the option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            to_default: If True, sets the option value to default value, else to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="k">if</span> <span class="n">to_default</span> <span class="k">else</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="StrOption.get_formatted"><a class="viewcode-back" href="../../../config.html#firebird.base.config.StrOption.get_formatted">[docs]</a>    <span class="k">def</span> <span class="nf">get_formatted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value formatted for use in config file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;UNDEFINED&gt;&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span>
        <span class="k">if</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">splitlines</span><span class="p">(</span><span class="kc">True</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">lines</span><span class="p">:</span>
                    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;   &#39;</span> <span class="o">+</span> <span class="n">line</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="StrOption.set_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.StrOption.set_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">set_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value from string.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span></div>
<div class="viewcode-block" id="StrOption.get_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.StrOption.get_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">get_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value as string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="StrOption.get_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.StrOption.get_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns current option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="StrOption.set_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.StrOption.set_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span></div>
<div class="viewcode-block" id="StrOption.load_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.StrOption.load_proto">[docs]</a>    <span class="k">def</span> <span class="nf">load_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Deserialize value from `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message that may contains options value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">opt</span><span class="o">.</span><span class="n">HasField</span><span class="p">(</span><span class="s1">&#39;as_string&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">as_string</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrong value type: </span><span class="si">{</span><span class="n">opt</span><span class="o">.</span><span class="n">WhichOneof</span><span class="p">(</span><span class="s1">&#39;kind&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="StrOption.save_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.StrOption.save_proto">[docs]</a>    <span class="k">def</span> <span class="nf">save_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Serialize value into `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message where option value should be stored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">as_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
    <span class="n">value</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_value</span><span class="p">,</span> <span class="n">set_value</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Current option value&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="IntOption"><a class="viewcode-back" href="../../../config.html#firebird.base.config.IntOption">[docs]</a><span class="k">class</span> <span class="nc">IntOption</span><span class="p">(</span><span class="n">Option</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Configuration option with integer value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="IntOption.__init__"><a class="viewcode-back" href="../../../config.html#firebird.base.config.IntOption.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">required</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">default</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">signed</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Arguments:</span>
<span class="sd">        name: Option name.</span>
<span class="sd">        description: Option description. Can span multiple lines.</span>
<span class="sd">        required: True if option must have a value.</span>
<span class="sd">        default: Default option value.</span>
<span class="sd">        signed: When False, the option value cannot be negative.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__signed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">signed</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">required</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span></div>
<div class="viewcode-block" id="IntOption.clear"><a class="viewcode-back" href="../../../config.html#firebird.base.config.IntOption.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">to_default</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clears the option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            to_default: If True, sets the option value to default value, else to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="k">if</span> <span class="n">to_default</span> <span class="k">else</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="IntOption.get_formatted"><a class="viewcode-back" href="../../../config.html#firebird.base.config.IntOption.get_formatted">[docs]</a>    <span class="k">def</span> <span class="nf">get_formatted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value formatted for use in config file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;UNDEFINED&gt;&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">)</span></div>
<div class="viewcode-block" id="IntOption.set_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.IntOption.set_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">set_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value from string.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__signed</span> <span class="ow">and</span> <span class="n">new</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Negative numbers not allowed&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">new</span></div>
<div class="viewcode-block" id="IntOption.get_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.IntOption.get_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">get_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value as string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">)</span></div>
<div class="viewcode-block" id="IntOption.get_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.IntOption.get_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns current option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="IntOption.set_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.IntOption.set_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__signed</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Negative numbers not allowed&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span></div>
<div class="viewcode-block" id="IntOption.load_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.IntOption.load_proto">[docs]</a>    <span class="k">def</span> <span class="nf">load_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Deserialize value from `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message that may contains options value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="n">oneof</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">WhichOneof</span><span class="p">(</span><span class="s1">&#39;kind&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">oneof</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;as_sint32&#39;</span><span class="p">,</span> <span class="s1">&#39;as_sint64&#39;</span><span class="p">,</span> <span class="s1">&#39;as_uint32&#39;</span><span class="p">,</span> <span class="s1">&#39;as_uint64&#39;</span><span class="p">,</span> <span class="s1">&#39;as_string&#39;</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrong value type: </span><span class="si">{</span><span class="n">oneof</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">oneof</span> <span class="o">==</span> <span class="s1">&#39;as_string&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_as_str</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">as_string</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">oneof</span><span class="p">))</span></div>
<div class="viewcode-block" id="IntOption.save_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.IntOption.save_proto">[docs]</a>    <span class="k">def</span> <span class="nf">save_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Serialize value into `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message where option value should be stored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__signed</span><span class="p">:</span>
                <span class="n">opt</span><span class="o">.</span><span class="n">as_sint64</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">opt</span><span class="o">.</span><span class="n">as_uint64</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
    <span class="n">value</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_value</span><span class="p">,</span> <span class="n">set_value</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Current option value&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FloatOption"><a class="viewcode-back" href="../../../config.html#firebird.base.config.FloatOption">[docs]</a><span class="k">class</span> <span class="nc">FloatOption</span><span class="p">(</span><span class="n">Option</span><span class="p">[</span><span class="nb">float</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Configuration option with float value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="FloatOption.__init__"><a class="viewcode-back" href="../../../config.html#firebird.base.config.FloatOption.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">required</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arguments:</span>
<span class="sd">            name: Option name.</span>
<span class="sd">            description: Option description. Can span multiple lines.</span>
<span class="sd">            required: True if option must have a value.</span>
<span class="sd">            default: Default option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">required</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span></div>
<div class="viewcode-block" id="FloatOption.clear"><a class="viewcode-back" href="../../../config.html#firebird.base.config.FloatOption.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">to_default</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clears the option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            to_default: If True, sets the option value to default value, else to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="k">if</span> <span class="n">to_default</span> <span class="k">else</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="FloatOption.get_formatted"><a class="viewcode-back" href="../../../config.html#firebird.base.config.FloatOption.get_formatted">[docs]</a>    <span class="k">def</span> <span class="nf">get_formatted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value formatted for use in config file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;UNDEFINED&gt;&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">)</span></div>
<div class="viewcode-block" id="FloatOption.set_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.FloatOption.set_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">set_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value from string.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="FloatOption.get_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.FloatOption.get_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">get_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value as string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">)</span></div>
<div class="viewcode-block" id="FloatOption.get_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.FloatOption.get_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns current option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="FloatOption.set_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.FloatOption.set_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span></div>
<div class="viewcode-block" id="FloatOption.load_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.FloatOption.load_proto">[docs]</a>    <span class="k">def</span> <span class="nf">load_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Deserialize value from `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message that may contains options value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="n">oneof</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">WhichOneof</span><span class="p">(</span><span class="s1">&#39;kind&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">oneof</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;as_float&#39;</span><span class="p">,</span> <span class="s1">&#39;as_double&#39;</span><span class="p">,</span> <span class="s1">&#39;as_string&#39;</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrong value type: </span><span class="si">{</span><span class="n">oneof</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">oneof</span> <span class="o">==</span> <span class="s1">&#39;as_string&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_as_str</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">as_string</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">oneof</span><span class="p">))</span></div>
<div class="viewcode-block" id="FloatOption.save_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.FloatOption.save_proto">[docs]</a>    <span class="k">def</span> <span class="nf">save_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Serialize value into `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message where option value should be stored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">as_double</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
    <span class="n">value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_value</span><span class="p">,</span> <span class="n">set_value</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Current option value&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="DecimalOption"><a class="viewcode-back" href="../../../config.html#firebird.base.config.DecimalOption">[docs]</a><span class="k">class</span> <span class="nc">DecimalOption</span><span class="p">(</span><span class="n">Option</span><span class="p">[</span><span class="n">Decimal</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Configuration option with decimal.Decimal value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="DecimalOption.__init__"><a class="viewcode-back" href="../../../config.html#firebird.base.config.DecimalOption.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">required</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">Decimal</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arguments:</span>
<span class="sd">            name: Option name.</span>
<span class="sd">            description: Option description. Can span multiple lines.</span>
<span class="sd">            required: True if option must have a value.</span>
<span class="sd">            default: Default option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span> <span class="n">Decimal</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">required</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span></div>
<div class="viewcode-block" id="DecimalOption.clear"><a class="viewcode-back" href="../../../config.html#firebird.base.config.DecimalOption.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">to_default</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clears the option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            to_default: If True, sets the option value to default value, else to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="k">if</span> <span class="n">to_default</span> <span class="k">else</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="DecimalOption.get_formatted"><a class="viewcode-back" href="../../../config.html#firebird.base.config.DecimalOption.get_formatted">[docs]</a>    <span class="k">def</span> <span class="nf">get_formatted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value formatted for use in config file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;UNDEFINED&gt;&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">)</span></div>
<div class="viewcode-block" id="DecimalOption.set_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.DecimalOption.set_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">set_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value from string.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">DecimalException</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">exc</span><span class="p">))</span> <span class="kn">from</span> <span class="nn">exc</span></div>
<div class="viewcode-block" id="DecimalOption.get_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.DecimalOption.get_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">get_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value as string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">)</span></div>
<div class="viewcode-block" id="DecimalOption.get_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.DecimalOption.get_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Decimal</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns current option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="DecimalOption.set_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.DecimalOption.set_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span></div>
<div class="viewcode-block" id="DecimalOption.load_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.DecimalOption.load_proto">[docs]</a>    <span class="k">def</span> <span class="nf">load_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deserialize value from `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message that may contains options value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="n">oneof</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">WhichOneof</span><span class="p">(</span><span class="s1">&#39;kind&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">oneof</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;as_sint32&#39;</span><span class="p">,</span> <span class="s1">&#39;as_sint64&#39;</span><span class="p">,</span> <span class="s1">&#39;as_uint32&#39;</span><span class="p">,</span> <span class="s1">&#39;as_uint64&#39;</span><span class="p">,</span> <span class="s1">&#39;as_string&#39;</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrong value type: </span><span class="si">{</span><span class="n">oneof</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">oneof</span> <span class="o">==</span> <span class="s1">&#39;as_string&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_as_str</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">as_string</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">oneof</span><span class="p">)))</span></div>
<div class="viewcode-block" id="DecimalOption.save_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.DecimalOption.save_proto">[docs]</a>    <span class="k">def</span> <span class="nf">save_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Serialize value into `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message where option value should be stored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">as_string</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">)</span></div>
    <span class="n">value</span><span class="p">:</span> <span class="n">Decimal</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_value</span><span class="p">,</span> <span class="n">set_value</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Current option value&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="BoolOption"><a class="viewcode-back" href="../../../config.html#firebird.base.config.BoolOption">[docs]</a><span class="k">class</span> <span class="nc">BoolOption</span><span class="p">(</span><span class="n">Option</span><span class="p">[</span><span class="nb">bool</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Configuration option with boolean value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="BoolOption.__init__"><a class="viewcode-back" href="../../../config.html#firebird.base.config.BoolOption.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">required</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arguments:</span>
<span class="sd">            name: Option name.</span>
<span class="sd">            description: Option description. Can span multiple lines.</span>
<span class="sd">            required: True if option must have a value.</span>
<span class="sd">            default: Default option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">from_str</span> <span class="o">=</span> <span class="n">get_convertor</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span><span class="o">.</span><span class="n">from_str</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">required</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span></div>
<div class="viewcode-block" id="BoolOption.clear"><a class="viewcode-back" href="../../../config.html#firebird.base.config.BoolOption.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">to_default</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clears the option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            to_default: If True, sets the option value to default value, else to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="k">if</span> <span class="n">to_default</span> <span class="k">else</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="BoolOption.get_formatted"><a class="viewcode-back" href="../../../config.html#firebird.base.config.BoolOption.get_formatted">[docs]</a>    <span class="k">def</span> <span class="nf">get_formatted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value formatted for use in config file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;UNDEFINED&gt;&#39;</span>
        <span class="k">return</span> <span class="s1">&#39;yes&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="k">else</span> <span class="s1">&#39;no&#39;</span></div>
<div class="viewcode-block" id="BoolOption.set_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.BoolOption.set_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">set_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value from string.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_str</span><span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="BoolOption.get_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.BoolOption.get_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">get_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value as string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">)</span></div>
<div class="viewcode-block" id="BoolOption.get_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.BoolOption.get_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns current option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="BoolOption.set_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.BoolOption.set_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span></div>
<div class="viewcode-block" id="BoolOption.load_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.BoolOption.load_proto">[docs]</a>    <span class="k">def</span> <span class="nf">load_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Deserialize value from `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message that may contains options value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="n">oneof</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">WhichOneof</span><span class="p">(</span><span class="s1">&#39;kind&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">oneof</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;as_bool&#39;</span><span class="p">,</span> <span class="s1">&#39;as_string&#39;</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrong value type: </span><span class="si">{</span><span class="n">oneof</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">oneof</span> <span class="o">==</span> <span class="s1">&#39;as_string&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_as_str</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">as_string</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">as_bool</span><span class="p">)</span></div>
<div class="viewcode-block" id="BoolOption.save_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.BoolOption.save_proto">[docs]</a>    <span class="k">def</span> <span class="nf">save_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Serialize value into `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message where option value should be stored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">as_bool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
    <span class="n">value</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_value</span><span class="p">,</span> <span class="n">set_value</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Current option value&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ZMQAddressOption"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ZMQAddressOption">[docs]</a><span class="k">class</span> <span class="nc">ZMQAddressOption</span><span class="p">(</span><span class="n">Option</span><span class="p">[</span><span class="n">ZMQAddress</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Configuration option with `.ZMQAddress` value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="ZMQAddressOption.__init__"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ZMQAddressOption.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">required</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">default</span><span class="p">:</span> <span class="n">ZMQAddress</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arguments:</span>
<span class="sd">            name: Option name.</span>
<span class="sd">            description: Option description. Can span multiple lines.</span>
<span class="sd">            required: True if option must have a value.</span>
<span class="sd">            default: Default option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span> <span class="n">ZMQAddress</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ZMQAddress</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">required</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span></div>
<div class="viewcode-block" id="ZMQAddressOption.clear"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ZMQAddressOption.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">to_default</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clears the option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            to_default: If True, sets the option value to default value, else to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="k">if</span> <span class="n">to_default</span> <span class="k">else</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="ZMQAddressOption.get_formatted"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ZMQAddressOption.get_formatted">[docs]</a>    <span class="k">def</span> <span class="nf">get_formatted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value formatted for use in config file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;UNDEFINED&gt;&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="ZMQAddressOption.set_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ZMQAddressOption.set_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">set_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value from string.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">ZMQAddress</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="ZMQAddressOption.get_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ZMQAddressOption.get_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">get_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value as string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="ZMQAddressOption.get_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ZMQAddressOption.get_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ZMQAddress</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns current option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="ZMQAddressOption.set_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ZMQAddressOption.set_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">ZMQAddress</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span></div>
<div class="viewcode-block" id="ZMQAddressOption.load_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ZMQAddressOption.load_proto">[docs]</a>    <span class="k">def</span> <span class="nf">load_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Deserialize value from `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message that may contains options value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">opt</span><span class="o">.</span><span class="n">HasField</span><span class="p">(</span><span class="s1">&#39;as_string&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_as_str</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">as_string</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrong value type: </span><span class="si">{</span><span class="n">opt</span><span class="o">.</span><span class="n">WhichOneof</span><span class="p">(</span><span class="s1">&#39;kind&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="ZMQAddressOption.save_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ZMQAddressOption.save_proto">[docs]</a>    <span class="k">def</span> <span class="nf">save_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Serialize value into `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message where option value should be stored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">as_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
    <span class="n">value</span><span class="p">:</span> <span class="n">ZMQAddress</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_value</span><span class="p">,</span> <span class="n">set_value</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Current option value&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="EnumOption"><a class="viewcode-back" href="../../../config.html#firebird.base.config.EnumOption">[docs]</a><span class="k">class</span> <span class="nc">EnumOption</span><span class="p">(</span><span class="n">Option</span><span class="p">[</span><span class="n">Enum</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Configuration option with enum value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="EnumOption.__init__"><a class="viewcode-back" href="../../../config.html#firebird.base.config.EnumOption.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">enum_class</span><span class="p">:</span> <span class="n">Enum</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">required</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">default</span><span class="p">:</span> <span class="n">Enum</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">allowed</span><span class="p">:</span> <span class="n">List</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arguments:</span>
<span class="sd">            name: Option name.</span>
<span class="sd">            description: Option description. Can span multiple lines.</span>
<span class="sd">            required: True if option must have a value.</span>
<span class="sd">            default: Default option value.</span>
<span class="sd">            allowed: List of allowed Enum members. When not defined, all members of enum type are</span>
<span class="sd">                     allowed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span> <span class="n">Enum</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1">#: List of allowed enum values.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allowed</span><span class="p">:</span> <span class="n">Sequence</span> <span class="o">=</span> <span class="n">enum_class</span> <span class="k">if</span> <span class="n">allowed</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">allowed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_members</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed</span><span class="p">}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">enum_class</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">required</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span></div>
    <span class="k">def</span> <span class="nf">_get_value_description</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;enum [</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed</span><span class="p">)</span><span class="si">}</span><span class="s2">]</span><span class="se">\n</span><span class="s2">&quot;</span>
<div class="viewcode-block" id="EnumOption.clear"><a class="viewcode-back" href="../../../config.html#firebird.base.config.EnumOption.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">to_default</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clears the option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            to_default: If True, sets the option value to default value, else to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="k">if</span> <span class="n">to_default</span> <span class="k">else</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="EnumOption.get_formatted"><a class="viewcode-back" href="../../../config.html#firebird.base.config.EnumOption.get_formatted">[docs]</a>    <span class="k">def</span> <span class="nf">get_formatted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value formatted for use in config file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;UNDEFINED&gt;&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span></div>
<div class="viewcode-block" id="EnumOption.set_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.EnumOption.set_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">set_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value from string.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_members</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_members</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Illegal value &#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39; for enum type &quot;</span>
                             <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">datatype</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="EnumOption.get_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.EnumOption.get_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">get_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value as string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="o">.</span><span class="n">name</span></div>
<div class="viewcode-block" id="EnumOption.get_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.EnumOption.get_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Enum</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns current option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="EnumOption.set_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.EnumOption.set_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Enum</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Value &#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39; not allowed&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span></div>
<div class="viewcode-block" id="EnumOption.load_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.EnumOption.load_proto">[docs]</a>    <span class="k">def</span> <span class="nf">load_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Deserialize value from `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message that may contains option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">opt</span><span class="o">.</span><span class="n">HasField</span><span class="p">(</span><span class="s1">&#39;as_string&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_as_str</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">as_string</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrong value type: </span><span class="si">{</span><span class="n">opt</span><span class="o">.</span><span class="n">WhichOneof</span><span class="p">(</span><span class="s1">&#39;kind&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="EnumOption.save_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.EnumOption.save_proto">[docs]</a>    <span class="k">def</span> <span class="nf">save_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Serialize value into `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message where option value should be stored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">as_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="o">.</span><span class="n">name</span></div>
    <span class="n">value</span><span class="p">:</span> <span class="n">Enum</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_value</span><span class="p">,</span> <span class="n">set_value</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Current option value&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FlagOption"><a class="viewcode-back" href="../../../config.html#firebird.base.config.FlagOption">[docs]</a><span class="k">class</span> <span class="nc">FlagOption</span><span class="p">(</span><span class="n">Option</span><span class="p">[</span><span class="n">Flag</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Configuration option with flag value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="FlagOption.__init__"><a class="viewcode-back" href="../../../config.html#firebird.base.config.FlagOption.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">flag_class</span><span class="p">:</span> <span class="n">Flag</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">required</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">default</span><span class="p">:</span> <span class="n">Flag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">allowed</span><span class="p">:</span> <span class="n">List</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arguments:</span>
<span class="sd">            name: Option name.</span>
<span class="sd">            description: Option description. Can span multiple lines.</span>
<span class="sd">            required: True if option must have a value.</span>
<span class="sd">            default: Default option value.</span>
<span class="sd">            allowed: List of allowed Flag members. When not defined, all members of flag type are</span>
<span class="sd">                     allowed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span> <span class="n">Flag</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1">#: List of allowed flag values.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allowed</span><span class="p">:</span> <span class="n">Sequence</span> <span class="o">=</span> <span class="n">flag_class</span> <span class="k">if</span> <span class="n">allowed</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">allowed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_members</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed</span><span class="p">}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">flag_class</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">required</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span></div>
    <span class="k">def</span> <span class="nf">_get_value_description</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;flag [</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed</span><span class="p">)</span><span class="si">}</span><span class="s2">]</span><span class="se">\n</span><span class="s2">&quot;</span>
<div class="viewcode-block" id="FlagOption.clear"><a class="viewcode-back" href="../../../config.html#firebird.base.config.FlagOption.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">to_default</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clears the option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            to_default: If True, sets the option value to default value, else to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="k">if</span> <span class="n">to_default</span> <span class="k">else</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="FlagOption.get_formatted"><a class="viewcode-back" href="../../../config.html#firebird.base.config.FlagOption.get_formatted">[docs]</a>    <span class="k">def</span> <span class="nf">get_formatted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value formatted for use in config file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;UNDEFINED&gt;&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_as_str</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span></div>
<div class="viewcode-block" id="FlagOption.set_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.FlagOption.set_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">set_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value from string.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">datatype</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span> <span class="k">if</span> <span class="s1">&#39;|&#39;</span> <span class="ow">in</span> <span class="n">value</span> <span class="k">else</span> <span class="s1">&#39;,&#39;</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_members</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_members</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Illegal value &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; for flag option &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="FlagOption.get_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.FlagOption.get_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">get_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value as string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="o">.</span><span class="n">_name_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="o">.</span><span class="n">name</span>
        <span class="n">members</span><span class="p">,</span> <span class="n">uncovered</span> <span class="o">=</span> <span class="n">_decompose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datatype</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">members</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">members</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_name_</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">members</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_value_</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="s1">&#39; | &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">_name_</span> <span class="ow">or</span> <span class="n">m</span><span class="o">.</span><span class="n">_value_</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">members</span><span class="p">])</span></div>
<div class="viewcode-block" id="FlagOption.get_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.FlagOption.get_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Flag</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns current option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="FlagOption.set_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.FlagOption.set_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Flag</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">members</span><span class="p">,</span> <span class="n">uncovered</span> <span class="o">=</span> <span class="n">_decompose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datatype</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">uncovered</span> <span class="ow">or</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">members</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_members</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Illegal value &#39;</span><span class="si">{</span><span class="n">value</span><span class="si">!s}</span><span class="s2">&#39; for flag option &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span></div>
<div class="viewcode-block" id="FlagOption.load_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.FlagOption.load_proto">[docs]</a>    <span class="k">def</span> <span class="nf">load_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Deserialize value from `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message that may contains option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="n">oneof</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">WhichOneof</span><span class="p">(</span><span class="s1">&#39;kind&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">oneof</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;as_uint64&#39;</span><span class="p">,</span> <span class="s1">&#39;as_string&#39;</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrong value type: </span><span class="si">{</span><span class="n">oneof</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">oneof</span> <span class="o">==</span> <span class="s1">&#39;as_uint64&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datatype</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">as_uint64</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_as_str</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">as_string</span><span class="p">)</span></div>
<div class="viewcode-block" id="FlagOption.save_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.FlagOption.save_proto">[docs]</a>    <span class="k">def</span> <span class="nf">save_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Serialize value into `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message where option value should be stored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">as_uint64</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="o">.</span><span class="n">value</span></div>
    <span class="n">value</span><span class="p">:</span> <span class="n">Flag</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_value</span><span class="p">,</span> <span class="n">set_value</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Current option value&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="UUIDOption"><a class="viewcode-back" href="../../../config.html#firebird.base.config.UUIDOption">[docs]</a><span class="k">class</span> <span class="nc">UUIDOption</span><span class="p">(</span><span class="n">Option</span><span class="p">[</span><span class="n">UUID</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Configuration option with UUID value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="UUIDOption.__init__"><a class="viewcode-back" href="../../../config.html#firebird.base.config.UUIDOption.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">required</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">UUID</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arguments:</span>
<span class="sd">            name: Option name.</span>
<span class="sd">            description: Option description. Can span multiple lines.</span>
<span class="sd">            required: True if option must have a value.</span>
<span class="sd">            default: Default option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span> <span class="n">UUID</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">UUID</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">required</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span></div>
<div class="viewcode-block" id="UUIDOption.clear"><a class="viewcode-back" href="../../../config.html#firebird.base.config.UUIDOption.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">to_default</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clears the option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            to_default: If True, sets the option value to default value, else to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="k">if</span> <span class="n">to_default</span> <span class="k">else</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="UUIDOption.get_formatted"><a class="viewcode-back" href="../../../config.html#firebird.base.config.UUIDOption.get_formatted">[docs]</a>    <span class="k">def</span> <span class="nf">get_formatted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value formatted for use in config file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;UNDEFINED&gt;&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">)</span></div>
<div class="viewcode-block" id="UUIDOption.set_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.UUIDOption.set_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">set_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value from string.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">UUID</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="UUIDOption.get_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.UUIDOption.get_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">get_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value as string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;None&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="o">.</span><span class="n">hex</span></div>
<div class="viewcode-block" id="UUIDOption.get_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.UUIDOption.get_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">UUID</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns current option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="UUIDOption.set_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.UUIDOption.set_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">UUID</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span></div>
<div class="viewcode-block" id="UUIDOption.load_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.UUIDOption.load_proto">[docs]</a>    <span class="k">def</span> <span class="nf">load_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Deserialize value from `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message that may contains options value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="n">oneof</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">WhichOneof</span><span class="p">(</span><span class="s1">&#39;kind&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">oneof</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;as_bytes&#39;</span><span class="p">,</span> <span class="s1">&#39;as_string&#39;</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrong value type: </span><span class="si">{</span><span class="n">oneof</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">oneof</span> <span class="o">==</span> <span class="s1">&#39;as_bytes&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">UUID</span><span class="p">(</span><span class="nb">bytes</span><span class="o">=</span><span class="n">opt</span><span class="o">.</span><span class="n">as_bytes</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">UUID</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">as_string</span><span class="p">))</span></div>
<div class="viewcode-block" id="UUIDOption.save_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.UUIDOption.save_proto">[docs]</a>    <span class="k">def</span> <span class="nf">save_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Serialize value into `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message where option value should be stored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">as_bytes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="o">.</span><span class="n">bytes</span></div>
    <span class="n">value</span><span class="p">:</span> <span class="n">UUID</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_value</span><span class="p">,</span> <span class="n">set_value</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Current option value&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MIMEOption"><a class="viewcode-back" href="../../../config.html#firebird.base.config.MIMEOption">[docs]</a><span class="k">class</span> <span class="nc">MIMEOption</span><span class="p">(</span><span class="n">Option</span><span class="p">[</span><span class="n">MIME</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Configuration option with MIME type specification value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="MIMEOption.__init__"><a class="viewcode-back" href="../../../config.html#firebird.base.config.MIMEOption.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">required</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">MIME</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arguments:</span>
<span class="sd">            name: Option name.</span>
<span class="sd">            description: Option description. Can span multiple lines.</span>
<span class="sd">            required: True if option must have a value.</span>
<span class="sd">            default: Default option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span> <span class="n">MIME</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">MIME</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">required</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span></div>
<div class="viewcode-block" id="MIMEOption.clear"><a class="viewcode-back" href="../../../config.html#firebird.base.config.MIMEOption.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">to_default</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clears the option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            to_default: If True, sets the option value to default value, else to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="k">if</span> <span class="n">to_default</span> <span class="k">else</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="MIMEOption.get_formatted"><a class="viewcode-back" href="../../../config.html#firebird.base.config.MIMEOption.get_formatted">[docs]</a>    <span class="k">def</span> <span class="nf">get_formatted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value formatted for use in config file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;UNDEFINED&gt;&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="MIMEOption.set_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.MIMEOption.set_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">set_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value from string.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">MIME</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="MIMEOption.get_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.MIMEOption.get_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">get_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value as string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;None&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="MIMEOption.get_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.MIMEOption.get_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MIME</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns current option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="MIMEOption.set_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.MIMEOption.set_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">MIME</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span></div>
<div class="viewcode-block" id="MIMEOption.load_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.MIMEOption.load_proto">[docs]</a>    <span class="k">def</span> <span class="nf">load_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Deserialize value from `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message that may contains options value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">opt</span><span class="o">.</span><span class="n">HasField</span><span class="p">(</span><span class="s1">&#39;as_string&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_as_str</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">as_string</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrong value type: </span><span class="si">{</span><span class="n">opt</span><span class="o">.</span><span class="n">WhichOneof</span><span class="p">(</span><span class="s1">&#39;kind&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="MIMEOption.save_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.MIMEOption.save_proto">[docs]</a>    <span class="k">def</span> <span class="nf">save_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Serialize value into `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message where option value should be stored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">as_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
    <span class="n">value</span><span class="p">:</span> <span class="n">MIME</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_value</span><span class="p">,</span> <span class="n">set_value</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Current option value&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ListOption"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ListOption">[docs]</a><span class="k">class</span> <span class="nc">ListOption</span><span class="p">(</span><span class="n">Option</span><span class="p">[</span><span class="n">List</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Configuration option with list of values.</span>

<span class="sd">    Important:</span>
<span class="sd">        When option is read from `ConfigParser`, empty values are ignored.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="ListOption.__init__"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ListOption.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">item_type</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Type</span><span class="p">]],</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                 <span class="o">*</span><span class="p">,</span> <span class="n">required</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">List</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">separator</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arguments:</span>
<span class="sd">            name:        Option name.</span>
<span class="sd">            item_type:   Datatype of list items. It could be a type or sequence of types.</span>
<span class="sd">                         If multiple types are provided, each value in config file must</span>
<span class="sd">                         have format: `type_name:value_as_str`.</span>
<span class="sd">            description: Option description. Can span multiple lines.</span>
<span class="sd">            required:    True if option must have a value.</span>
<span class="sd">            default:     Default option value.</span>
<span class="sd">            separator:   String that separates list item values when options value is read</span>
<span class="sd">                         from `ConfigParser`. It&#39;s possible to use a line break as separator.</span>
<span class="sd">                         If separator is `None` [default] and the value contains line breaks,</span>
<span class="sd">                         it uses the line break as separator, otherwise it uses comma as</span>
<span class="sd">                         separator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1">#: Datatypes of list items. If there is more than one type, each value in</span>
        <span class="c1">#: config file must have format: `type_name:value_as_str`.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item_types</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Type</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">item_type</span><span class="p">,</span> <span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item_type</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="k">else</span> <span class="n">item_type</span>
        <span class="c1">#: String that separates list item values when options value is read from</span>
        <span class="c1">#: `ConfigParser`. Default separator is None. It&#39;s possible to use a line break as</span>
        <span class="c1">#: separator. If separator is `None` and the value contains line breaks, it uses</span>
        <span class="c1">#: the line break as separator, otherwise it uses comma as separator.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">separator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">separator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_convertor</span><span class="p">:</span> <span class="n">Convertor</span> <span class="o">=</span> <span class="n">get_convertor</span><span class="p">(</span><span class="n">item_type</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item_type</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">required</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span></div>
    <span class="k">def</span> <span class="nf">_get_value_description</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;list [</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_types</span><span class="p">)</span><span class="si">}</span><span class="s2">]</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">def</span> <span class="nf">_check_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">List</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_types</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;List item[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">] has wrong type&quot;</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">def</span> <span class="nf">_get_as_typed_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">convert_to_str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">item_types</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">result</span>
<div class="viewcode-block" id="ListOption.clear"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ListOption.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">to_default</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clears the option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            to_default: If True, sets the option value to default value, else to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="k">if</span> <span class="n">to_default</span> <span class="k">else</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="ListOption.get_formatted"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ListOption.get_formatted">[docs]</a>    <span class="k">def</span> <span class="nf">get_formatted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value formatted for use in config file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;UNDEFINED&gt;&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">convert_to_str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">]</span>
        <span class="n">sep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">separator</span>
        <span class="k">if</span> <span class="n">sep</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">80</span> <span class="k">else</span> <span class="s1">&#39;,&#39;</span>
        <span class="k">if</span> <span class="n">sep</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">   &#39;</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">sep</span><span class="si">}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="ListOption.set_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ListOption.set_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">set_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value from string.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
            <span class="n">separator</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">value</span> <span class="k">else</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">separator</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">separator</span>
            <span class="n">itype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_types</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">convertor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convertor</span>
            <span class="n">name_map</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">item_types</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">name_map</span> <span class="o">=</span> <span class="p">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="bp">cls</span> <span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_types</span><span class="p">}</span>
                <span class="n">fullname_map</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="bp">cls</span> <span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_types</span><span class="p">}</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">strip</span><span class="p">()):</span>
                <span class="k">if</span> <span class="n">name_map</span><span class="p">:</span>
                    <span class="n">itype_name</span><span class="p">,</span> <span class="n">item</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">itype_name</span> <span class="o">=</span> <span class="n">itype_name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">itype</span> <span class="o">=</span> <span class="n">fullname_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">itype_name</span><span class="p">)</span> <span class="k">if</span> <span class="s1">&#39;.&#39;</span> <span class="ow">in</span> <span class="n">itype_name</span> <span class="k">else</span> <span class="n">name_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">itype_name</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">itype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Item type &#39;</span><span class="si">{</span><span class="n">itype_name</span><span class="si">}</span><span class="s2">&#39; not supported&quot;</span><span class="p">)</span>
                    <span class="n">convertor</span> <span class="o">=</span> <span class="n">get_convertor</span><span class="p">(</span><span class="n">itype</span><span class="p">)</span>
                <span class="n">new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convertor</span><span class="o">.</span><span class="n">from_str</span><span class="p">(</span><span class="n">itype</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">strip</span><span class="p">()))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">new</span></div>
<div class="viewcode-block" id="ListOption.get_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ListOption.get_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">get_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value as string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">convert_to_str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">]</span>
        <span class="n">sep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">separator</span>
        <span class="k">if</span> <span class="n">sep</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">80</span> <span class="k">else</span> <span class="s1">&#39;,&#39;</span>
        <span class="k">return</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="ListOption.get_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ListOption.get_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns current option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="ListOption.set_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ListOption.set_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">List</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">list</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="ListOption.load_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ListOption.load_proto">[docs]</a>    <span class="k">def</span> <span class="nf">load_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Deserialize value from `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message that may contains options value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">opt</span><span class="o">.</span><span class="n">HasField</span><span class="p">(</span><span class="s1">&#39;as_string&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_as_str</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">as_string</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrong value type: </span><span class="si">{</span><span class="n">opt</span><span class="o">.</span><span class="n">WhichOneof</span><span class="p">(</span><span class="s1">&#39;kind&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="ListOption.save_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ListOption.save_proto">[docs]</a>    <span class="k">def</span> <span class="nf">save_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Serialize value into `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message where option value should be stored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_as_typed_str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">]</span>
            <span class="n">sep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">separator</span>
            <span class="k">if</span> <span class="n">sep</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">80</span> <span class="k">else</span> <span class="s1">&#39;,&#39;</span>
            <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">as_string</span> <span class="o">=</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
    <span class="n">value</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_value</span><span class="p">,</span> <span class="n">set_value</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Current option value&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyExprOption"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyExprOption">[docs]</a><span class="k">class</span> <span class="nc">PyExprOption</span><span class="p">(</span><span class="n">Option</span><span class="p">[</span><span class="n">PyExpr</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;String configuration option with Python expression value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">required</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">PyExpr</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span> <span class="n">PyExpr</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arguments:</span>
<span class="sd">            name: Option name.</span>
<span class="sd">            description: Option description. Can span multiple lines.</span>
<span class="sd">            required: True if option must have a value.</span>
<span class="sd">            default: Default option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">PyExpr</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">required</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<div class="viewcode-block" id="PyExprOption.clear"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyExprOption.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">to_default</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clears the option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            to_default: If True, sets the option value to default value, else to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="k">if</span> <span class="n">to_default</span> <span class="k">else</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="PyExprOption.get_formatted"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyExprOption.get_formatted">[docs]</a>    <span class="k">def</span> <span class="nf">get_formatted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value formatted for use in config file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;UNDEFINED&gt;&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span>
        <span class="k">if</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">splitlines</span><span class="p">(</span><span class="kc">True</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">lines</span><span class="p">:</span>
                    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;   &#39;</span> <span class="o">+</span> <span class="n">line</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="PyExprOption.set_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyExprOption.set_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">set_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value from string.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">PyExpr</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="PyExprOption.get_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyExprOption.get_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">get_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value as string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="PyExprOption.get_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyExprOption.get_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PyExpr</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns current option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="PyExprOption.set_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyExprOption.set_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">PyExpr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span></div>
<div class="viewcode-block" id="PyExprOption.load_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyExprOption.load_proto">[docs]</a>    <span class="k">def</span> <span class="nf">load_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Deserialize value from `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message that may contains options value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">opt</span><span class="o">.</span><span class="n">HasField</span><span class="p">(</span><span class="s1">&#39;as_string&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_as_str</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">as_string</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrong value type: </span><span class="si">{</span><span class="n">opt</span><span class="o">.</span><span class="n">WhichOneof</span><span class="p">(</span><span class="s1">&#39;kind&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="PyExprOption.save_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyExprOption.save_proto">[docs]</a>    <span class="k">def</span> <span class="nf">save_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Serialize value into `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message where option value should be stored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">as_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
    <span class="n">value</span><span class="p">:</span> <span class="n">PyExpr</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_value</span><span class="p">,</span> <span class="n">set_value</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Current option value&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyCodeOption"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyCodeOption">[docs]</a><span class="k">class</span> <span class="nc">PyCodeOption</span><span class="p">(</span><span class="n">Option</span><span class="p">[</span><span class="n">PyCode</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;String configuration option with Python code value.</span>

<span class="sd">    Important:</span>
<span class="sd">        Python code must be properly indented, but ConfigParser multiline string values have</span>
<span class="sd">        leading whitespace removed. To circumvent this, the `PyCodeOption` supports assignment</span>
<span class="sd">        of text values where lines start with `|` character. This character is removed, along</span>
<span class="sd">        with any number of subsequent whitespace characters that are between `|` and first</span>
<span class="sd">        non-whitespace character on first line starting with `|`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">required</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">PyCode</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span> <span class="n">PyCode</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arguments:</span>
<span class="sd">            name: Option name.</span>
<span class="sd">            description: Option description. Can span multiple lines.</span>
<span class="sd">            required: True if option must have a value.</span>
<span class="sd">            default: Default option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">PyCode</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">required</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<div class="viewcode-block" id="PyCodeOption.clear"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyCodeOption.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">to_default</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clears the option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            to_default: If True, sets the option value to default value, else to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="k">if</span> <span class="n">to_default</span> <span class="k">else</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="PyCodeOption.get_formatted"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyCodeOption.get_formatted">[docs]</a>    <span class="k">def</span> <span class="nf">get_formatted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value formatted for use in config file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;UNDEFINED&gt;&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span>
        <span class="k">if</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">splitlines</span><span class="p">(</span><span class="kc">True</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">lines</span><span class="p">:</span>
                    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;   | &#39;</span> <span class="o">+</span> <span class="n">line</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="PyCodeOption.set_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyCodeOption.set_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">set_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value from string.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">unindent_verticals</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">PyCode</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="PyCodeOption.get_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyCodeOption.get_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">get_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value as string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="PyCodeOption.get_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyCodeOption.get_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PyCode</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns current option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="PyCodeOption.set_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyCodeOption.set_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">PyCode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span></div>
<div class="viewcode-block" id="PyCodeOption.load_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyCodeOption.load_proto">[docs]</a>    <span class="k">def</span> <span class="nf">load_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Deserialize value from `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message that may contains options value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">opt</span><span class="o">.</span><span class="n">HasField</span><span class="p">(</span><span class="s1">&#39;as_string&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_as_str</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">as_string</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrong value type: </span><span class="si">{</span><span class="n">opt</span><span class="o">.</span><span class="n">WhichOneof</span><span class="p">(</span><span class="s1">&#39;kind&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="PyCodeOption.save_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyCodeOption.save_proto">[docs]</a>    <span class="k">def</span> <span class="nf">save_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Serialize value into `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message where option value should be stored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">as_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
    <span class="n">value</span><span class="p">:</span> <span class="n">PyCode</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_value</span><span class="p">,</span> <span class="n">set_value</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Current option value&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyCallableOption"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyCallableOption">[docs]</a><span class="k">class</span> <span class="nc">PyCallableOption</span><span class="p">(</span><span class="n">Option</span><span class="p">[</span><span class="n">PyCallable</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;String configuration option with Python callable value.</span>

<span class="sd">    Important:</span>
<span class="sd">        Python code must be properly indented, but `ConfigParser` multiline string values have</span>
<span class="sd">        leading whitespace removed. To circumvent this, the `PyCodeOption` supports assignment</span>
<span class="sd">        of text values where lines start with `|` character. This character is removed, along</span>
<span class="sd">        with any number of subsequent whitespace characters that are between `|` and first</span>
<span class="sd">        non-whitespace character on first line starting with `|`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=[W0621]</span>
<div class="viewcode-block" id="PyCallableOption.__init__"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyCallableOption.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">signature</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Signature</span><span class="p">,</span> <span class="n">Callable</span><span class="p">],</span> <span class="o">*</span> <span class="p">,</span>
                 <span class="n">required</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">PyCallable</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arguments:</span>
<span class="sd">            name: Option name.</span>
<span class="sd">            description: Option description. Can span multiple lines.</span>
<span class="sd">            signature: Callable signature or callable.</span>
<span class="sd">            required: True if option must have a value.</span>
<span class="sd">            default: Default option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span> <span class="n">PyCallable</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1">#: Callable signature.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">signature</span><span class="p">,</span> <span class="n">Signature</span><span class="p">):</span>
            <span class="n">signature</span> <span class="o">=</span> <span class="n">Signature</span><span class="o">.</span><span class="n">from_callable</span><span class="p">(</span><span class="n">PyCallable</span><span class="p">(</span><span class="n">signature</span><span class="p">)</span><span class="o">.</span><span class="n">_callable_</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">signature</span><span class="p">:</span> <span class="n">Signature</span> <span class="o">=</span> <span class="n">signature</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">PyCallable</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="n">required</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">)</span></div>
<div class="viewcode-block" id="PyCallableOption.clear"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyCallableOption.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">to_default</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clears the option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            to_default: If True, sets the option value to default value, else to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="k">if</span> <span class="n">to_default</span> <span class="k">else</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="PyCallableOption.get_formatted"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyCallableOption.get_formatted">[docs]</a>    <span class="k">def</span> <span class="nf">get_formatted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value formatted for use in config file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;UNDEFINED&gt;&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span>
        <span class="k">if</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">splitlines</span><span class="p">(</span><span class="kc">True</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">lines</span><span class="p">:</span>
                    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;   | &#39;</span> <span class="o">+</span> <span class="n">line</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="PyCallableOption.set_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyCallableOption.set_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">set_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value from string.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">unindent_verticals</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">PyCallable</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></div>
<div class="viewcode-block" id="PyCallableOption.get_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyCallableOption.get_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">get_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value as string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="PyCallableOption.get_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyCallableOption.get_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PyCallable</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns current option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="PyCallableOption.set_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyCallableOption.set_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">PyCallable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the callable has wrong signature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">val_sig</span> <span class="o">=</span> <span class="n">signature</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">_callable_</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">_eq</span><span class="p">(</span><span class="n">val_sig</span><span class="o">.</span><span class="n">return_annotation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signature</span><span class="o">.</span><span class="n">return_annotation</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Wrong callable return type&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">val_sig</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signature</span><span class="o">.</span><span class="n">parameters</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Wrong number of parameters&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">signature</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">val_par</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">=</span> <span class="n">val_sig</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="n">cast</span><span class="p">(</span><span class="n">Signature</span><span class="p">,</span> <span class="n">par</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">_eq</span><span class="p">(</span><span class="n">val_par</span><span class="o">.</span><span class="n">annotation</span><span class="p">,</span> <span class="n">cast</span><span class="p">(</span><span class="n">Signature</span><span class="p">,</span> <span class="n">par</span><span class="p">)</span><span class="o">.</span><span class="n">annotation</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrong type, parameter &#39;</span><span class="si">{</span><span class="n">val_par</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">_eq</span><span class="p">(</span><span class="n">val_par</span><span class="o">.</span><span class="n">default</span><span class="p">,</span> <span class="n">cast</span><span class="p">(</span><span class="n">Signature</span><span class="p">,</span> <span class="n">par</span><span class="p">)</span><span class="o">.</span><span class="n">default</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrong default, parameter &#39;</span><span class="si">{</span><span class="n">val_par</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">_eq</span><span class="p">(</span><span class="n">val_par</span><span class="o">.</span><span class="n">kind</span><span class="p">,</span> <span class="n">cast</span><span class="p">(</span><span class="n">Signature</span><span class="p">,</span> <span class="n">par</span><span class="p">)</span><span class="o">.</span><span class="n">kind</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrong parameter kind, parameter &#39;</span><span class="si">{</span><span class="n">val_par</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span></div>
<div class="viewcode-block" id="PyCallableOption.load_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyCallableOption.load_proto">[docs]</a>    <span class="k">def</span> <span class="nf">load_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Deserialize value from `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message that may contains options value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">opt</span><span class="o">.</span><span class="n">HasField</span><span class="p">(</span><span class="s1">&#39;as_string&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_as_str</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">as_string</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrong value type: </span><span class="si">{</span><span class="n">opt</span><span class="o">.</span><span class="n">WhichOneof</span><span class="p">(</span><span class="s1">&#39;kind&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="PyCallableOption.save_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PyCallableOption.save_proto">[docs]</a>    <span class="k">def</span> <span class="nf">save_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Serialize value into `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message where option value should be stored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">as_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
    <span class="n">value</span><span class="p">:</span> <span class="n">PyCallable</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_value</span><span class="p">,</span> <span class="n">set_value</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Current option value&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ConfigOption"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ConfigOption">[docs]</a><span class="k">class</span> <span class="nc">ConfigOption</span><span class="p">(</span><span class="n">Option</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Configuration option with `Config` value.</span>

<span class="sd">    Important:</span>
<span class="sd">        This option is intended for sub-configs that should have *configurable* name (i.e. the</span>
<span class="sd">        section name that holds sub-config values). To create sub-configs with fixed section</span>
<span class="sd">        names, simply assign them to instance attributes of `Config` instance that owns them</span>
<span class="sd">        (preferably in constructor).</span>

<span class="sd">        While the `value` attribute for this option is an instance of any class inherited from</span>
<span class="sd">        `Config`, in other ways it behaves like `StrOption` that loads/saves only name of its</span>
<span class="sd">        `Config` value (i.e. the section name). The actual I/O for sub-config&#39;s options is</span>
<span class="sd">        delegated to `Config` instance that owns this option.</span>

<span class="sd">        The &quot;empty&quot; value for this option is not `None` (because the `Config` instance always</span>
<span class="sd">        exists), but an empty string for `Config.name` attribute.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="ConfigOption.__init__"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ConfigOption.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Config</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">required</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">default</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arguments:</span>
<span class="sd">            name: Option name.</span>
<span class="sd">            description: Option description. Can span multiple lines.</span>
<span class="sd">            config: Option&#39;s value.</span>
<span class="sd">            required: True if option must have a value.</span>
<span class="sd">            default: Default `Config.name` value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">Config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span> <span class="n">Config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">required</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span></div>
    <span class="k">def</span> <span class="nf">_get_value_description</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;configuration section name</span><span class="se">\n</span><span class="s2">&quot;</span>
<div class="viewcode-block" id="ConfigOption.validate"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ConfigOption.validate">[docs]</a>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Validates option state.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Error: When required option does not have a value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">required</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing value for required option &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="ConfigOption.clear"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ConfigOption.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">to_default</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clears the option value.</span>

<span class="sd">        Note:</span>
<span class="sd">           This method calls `~Config.clear(to_default)`.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            to_default: If True, sets the `Config.name` to default value, else to empty string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">to_default</span><span class="o">=</span><span class="n">to_default</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="k">if</span> <span class="n">to_default</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span></div>
<div class="viewcode-block" id="ConfigOption.get_formatted"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ConfigOption.get_formatted">[docs]</a>    <span class="k">def</span> <span class="nf">get_formatted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return value formatted for use in config file.</span>

<span class="sd">        The string contains section name that will be used to store the `Config` values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="o">.</span><span class="n">name</span></div>
<div class="viewcode-block" id="ConfigOption.set_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ConfigOption.set_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">set_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value from string.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New `Config.name` value.</span>

<span class="sd">        Important:</span>
<span class="sd">            Because the actual value is a `Config` instance, the string must contain the</span>
<span class="sd">            `Config.name` value (which is the section name used to store `Config` options).</span>
<span class="sd">            Beware that multiple Config instances with the same (section) name may cause</span>
<span class="sd">            collision when configuration is written to protobuf message or configuration file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">value</span></div>
<div class="viewcode-block" id="ConfigOption.get_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ConfigOption.get_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">get_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return value as string.</span>

<span class="sd">        Important:</span>
<span class="sd">            Because the actual value is a `Config` instance, the returned string is the section</span>
<span class="sd">            name used to store `Config` options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="o">.</span><span class="n">name</span></div>
<div class="viewcode-block" id="ConfigOption.get_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ConfigOption.get_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Config</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns current option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="ConfigOption.set_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ConfigOption.set_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value.</span>

<span class="sd">        This option type does not support direct assignment of `Config` value. Because this method</span>
<span class="sd">        is also used to assign default value (which is a `Config.name`), it accepts None or string</span>
<span class="sd">        argument that is interpreted as new Config name. `None` value is translated to empty string.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New `Config` name.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When None or empty string is passed and option value is required.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">required</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Value is required for option &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">value</span></div>
<div class="viewcode-block" id="ConfigOption.load_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ConfigOption.load_proto">[docs]</a>    <span class="k">def</span> <span class="nf">load_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Deserialize value from `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message that may contains options value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">opt</span><span class="o">.</span><span class="n">HasField</span><span class="p">(</span><span class="s1">&#39;as_string&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_as_str</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">as_string</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrong value type: </span><span class="si">{</span><span class="n">opt</span><span class="o">.</span><span class="n">WhichOneof</span><span class="p">(</span><span class="s1">&#39;kind&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="ConfigOption.save_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ConfigOption.save_proto">[docs]</a>    <span class="k">def</span> <span class="nf">save_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Serialize value into `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message where option value should be stored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">as_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="o">.</span><span class="n">name</span></div>
    <span class="n">value</span><span class="p">:</span> <span class="n">Config</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_value</span><span class="p">,</span> <span class="n">set_value</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Current option value&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ConfigListOption"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ConfigListOption">[docs]</a><span class="k">class</span> <span class="nc">ConfigListOption</span><span class="p">(</span><span class="n">Option</span><span class="p">[</span><span class="n">List</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Configuration option with list of `Config` values.</span>

<span class="sd">    Important:</span>
<span class="sd">        This option is intended for configurable set of sub-configs of fixed type.</span>

<span class="sd">        While the `value` attribute for this option is a list of instances of single class</span>
<span class="sd">        inherited from `Config`, in other ways it behaves like `ListOption` with `str` items</span>
<span class="sd">        that loads/saves only names of its `Config` items (i.e. the section names). The actual</span>
<span class="sd">        I/O for sub-config options is delegated to `Config` instance that owns this option.</span>

<span class="sd">    Important:</span>
<span class="sd">        When option is read from `ConfigParser`, empty values are ignored.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="ConfigListOption.__init__"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ConfigListOption.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">item_type</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">Config</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span>
                 <span class="n">required</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">separator</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arguments:</span>
<span class="sd">            name:        Option name.</span>
<span class="sd">            description: Option description. Can span multiple lines.</span>
<span class="sd">            item_type:   Datatype of list items. Must be subclass of `Config`.</span>
<span class="sd">            required:    True if option must have a value.</span>
<span class="sd">            separator:   String that separates values when options value is read from `ConfigParser`.</span>
<span class="sd">                         It&#39;s possible to use a line break as separator.</span>
<span class="sd">                         If separator is `None` [default] and the value contains line breaks, it uses</span>
<span class="sd">                         the line break as separator, otherwise it uses comma as separator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">item_type</span><span class="p">,</span> <span class="n">Config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1">#: Datatype of list items.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item_type</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">Config</span><span class="p">]</span> <span class="o">=</span> <span class="n">item_type</span>
        <span class="c1">#: String that separates values when options value is read from `ConfigParser`.</span>
        <span class="c1">#: Default separator is None. It&#39;s possible to use a line break as separator.</span>
        <span class="c1">#: If separator is `None` and the value contains line breaks, it uses the line</span>
        <span class="c1">#: break as separator, otherwise it uses comma as separator.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">separator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">separator</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">required</span><span class="p">,</span> <span class="p">[])</span></div>
    <span class="k">def</span> <span class="nf">_get_value_description</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;list of configuration section names</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">def</span> <span class="nf">_check_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">List</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_type</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;List item[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">] has wrong type&quot;</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
<div class="viewcode-block" id="ConfigListOption.clear"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ConfigListOption.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">to_default</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clears the option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            to_default: If True, sets the option value to default value, else to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>
<div class="viewcode-block" id="ConfigListOption.get_formatted"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ConfigListOption.get_formatted">[docs]</a>    <span class="k">def</span> <span class="nf">get_formatted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value formatted for use in config file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;UNDEFINED&gt;&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">]</span>
        <span class="n">sep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">separator</span>
        <span class="k">if</span> <span class="n">sep</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">80</span> <span class="k">else</span> <span class="s1">&#39;,&#39;</span>
        <span class="k">if</span> <span class="n">sep</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">   &#39;</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">sep</span><span class="si">}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="ConfigListOption.set_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ConfigListOption.set_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">set_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value from string.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
            <span class="n">separator</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">value</span> <span class="k">else</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">separator</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">separator</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">strip</span><span class="p">()):</span>
                <span class="n">new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">item_type</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">strip</span><span class="p">()))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">new</span></div>
<div class="viewcode-block" id="ConfigListOption.get_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ConfigListOption.get_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">get_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value as string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">]</span>
        <span class="n">sep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">separator</span>
        <span class="k">if</span> <span class="n">sep</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">80</span> <span class="k">else</span> <span class="s1">&#39;,&#39;</span>
        <span class="k">return</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="ConfigListOption.get_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ConfigListOption.get_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns current option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="ConfigListOption.set_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ConfigListOption.set_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">List</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="ConfigListOption.load_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ConfigListOption.load_proto">[docs]</a>    <span class="k">def</span> <span class="nf">load_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Deserialize value from `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message that may contains options value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">opt</span><span class="o">.</span><span class="n">HasField</span><span class="p">(</span><span class="s1">&#39;as_string&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_as_str</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">as_string</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrong value type: </span><span class="si">{</span><span class="n">opt</span><span class="o">.</span><span class="n">WhichOneof</span><span class="p">(</span><span class="s1">&#39;kind&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="ConfigListOption.save_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.ConfigListOption.save_proto">[docs]</a>    <span class="k">def</span> <span class="nf">save_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Serialize value into `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message where option value should be stored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">]</span>
        <span class="n">sep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">separator</span>
        <span class="k">if</span> <span class="n">sep</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">80</span> <span class="k">else</span> <span class="s1">&#39;,&#39;</span>
        <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">as_string</span> <span class="o">=</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
    <span class="n">value</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_value</span><span class="p">,</span> <span class="n">set_value</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Current option value&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataclassOption"><a class="viewcode-back" href="../../../config.html#firebird.base.config.DataclassOption">[docs]</a><span class="k">class</span> <span class="nc">DataclassOption</span><span class="p">(</span><span class="n">Option</span><span class="p">[</span><span class="n">Any</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Configuration option with a dataclass value.</span>

<span class="sd">    The `ConfigParser` format for this option is a list of values, where each list items</span>
<span class="sd">    defines value for dataclass field in `field_name:value_as_str` format. The configuration</span>
<span class="sd">    must contain values for all fields for the dataclass that does not have default value.</span>

<span class="sd">    Important:</span>
<span class="sd">        This option uses type annotation for dataclass to determine the actual data type for</span>
<span class="sd">        conversion from string. It means that:</span>

<span class="sd">        1. If type annotation contains &quot;typing&quot; types, it&#39;s necessary to specify &quot;real&quot; types</span>
<span class="sd">           for all dataclass fields using the `fields` argument.</span>
<span class="sd">        2. All used data types must have string convertors registered in `strconv` module.</span>

<span class="sd">    Important:</span>
<span class="sd">        When option is read from `ConfigParser`, empty values are ignored.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="DataclassOption.__init__"><a class="viewcode-back" href="../../../config.html#firebird.base.config.DataclassOption.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dataclass</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">required</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">default</span><span class="p">:</span> <span class="n">Any</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">separator</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fields</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Type</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arguments:</span>
<span class="sd">            name:        Option name.</span>
<span class="sd">            dataclass:   Dataclass type.</span>
<span class="sd">            description: Option description. Can span multiple lines.</span>
<span class="sd">            required:    True if option must have a value.</span>
<span class="sd">            default:     Default option value.</span>
<span class="sd">            separator:   String that separates dataclass field values when options value is read</span>
<span class="sd">                         from `ConfigParser`. It&#39;s possible to use a line break as separator.</span>
<span class="sd">                         If separator is `None` [default] and the value contains line breaks, it</span>
<span class="sd">                         uses the line break as separator, otherwise it uses comma as separator.</span>
<span class="sd">            fields:      Dictionary that maps dataclass field names to data types.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">dataclass</span><span class="p">,</span> <span class="s1">&#39;__dataclass_fields__&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Type</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_type_hints</span><span class="p">(</span><span class="n">dataclass</span><span class="p">)</span> <span class="k">if</span> <span class="n">fields</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">fields</span>
        <span class="k">if</span> <span class="n">__debug__</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ftype</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">assert</span> <span class="n">get_convertor</span><span class="p">(</span><span class="n">ftype</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1">#: Dataclass type.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataclass</span><span class="p">:</span> <span class="n">Type</span> <span class="o">=</span> <span class="n">dataclass</span>
        <span class="c1">#: String that separates dataclass field values when options value is read from</span>
        <span class="c1">#: `ConfigParser`. Default separator is None. It&#39;s possible to use a line break</span>
        <span class="c1">#: as separator. If separator is `None` and the value contains line breaks, it</span>
        <span class="c1">#: uses the line break as separator, otherwise it uses comma as separator.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">separator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">separator</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">required</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span></div>
    <span class="k">def</span> <span class="nf">_get_value_description</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;list of values, where each list item defines value for a dataclass field.</span><span class="se">\n</span><span class="s2">&quot;</span> \
               <span class="s2">&quot;Item format: field_name:value_as_str</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">def</span> <span class="nf">_get_str_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">fname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">convert_to_str</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">,</span> <span class="n">fname</span><span class="p">))</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>
<div class="viewcode-block" id="DataclassOption.clear"><a class="viewcode-back" href="../../../config.html#firebird.base.config.DataclassOption.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">to_default</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clears the option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            to_default: If True, sets the option value to default value, else to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="k">if</span> <span class="n">to_default</span> <span class="k">else</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="DataclassOption.get_formatted"><a class="viewcode-back" href="../../../config.html#firebird.base.config.DataclassOption.get_formatted">[docs]</a>    <span class="k">def</span> <span class="nf">get_formatted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value formatted for use in config file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;UNDEFINED&gt;&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_str_fields</span><span class="p">()</span>
        <span class="n">sep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">separator</span>
        <span class="k">if</span> <span class="n">sep</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">80</span> <span class="k">else</span> <span class="s1">&#39;,&#39;</span>
        <span class="k">if</span> <span class="n">sep</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">   &#39;</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">sep</span><span class="si">}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="DataclassOption.set_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.DataclassOption.set_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">set_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value from string.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
            <span class="n">separator</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">value</span> <span class="k">else</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">separator</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">separator</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">strip</span><span class="p">()):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">field_name</span><span class="p">,</span> <span class="n">field_value</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Illegal value &#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39; for option &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">exc</span>
                <span class="n">field_name</span> <span class="o">=</span> <span class="n">field_name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="n">ftype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ftype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown data field &#39;</span><span class="si">{</span><span class="n">field_name</span><span class="si">}</span><span class="s2">&#39; for option &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
                <span class="n">convertor</span> <span class="o">=</span> <span class="n">get_convertor</span><span class="p">(</span><span class="n">ftype</span><span class="p">)</span>
                <span class="n">new</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">convertor</span><span class="o">.</span><span class="n">from_str</span><span class="p">(</span><span class="n">ftype</span><span class="p">,</span> <span class="n">field_value</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">new_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="o">**</span><span class="n">new</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Illegal value &#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39; for option &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">exc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">new_val</span></div>
<div class="viewcode-block" id="DataclassOption.get_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.DataclassOption.get_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">get_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value as string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_str_fields</span><span class="p">()</span>
        <span class="n">sep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">separator</span>
        <span class="k">if</span> <span class="n">sep</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">80</span> <span class="k">else</span> <span class="s1">&#39;,&#39;</span>
        <span class="k">return</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="DataclassOption.get_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.DataclassOption.get_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns current option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="DataclassOption.set_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.DataclassOption.set_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span></div>
<div class="viewcode-block" id="DataclassOption.load_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.DataclassOption.load_proto">[docs]</a>    <span class="k">def</span> <span class="nf">load_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Deserialize value from `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message that may contains options value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">opt</span><span class="o">.</span><span class="n">HasField</span><span class="p">(</span><span class="s1">&#39;as_string&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_as_str</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">as_string</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrong value type: </span><span class="si">{</span><span class="n">opt</span><span class="o">.</span><span class="n">WhichOneof</span><span class="p">(</span><span class="s1">&#39;kind&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="DataclassOption.save_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.DataclassOption.save_proto">[docs]</a>    <span class="k">def</span> <span class="nf">save_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Serialize value into `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message where option value should be stored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_str_fields</span><span class="p">()</span>
            <span class="n">sep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">separator</span>
            <span class="k">if</span> <span class="n">sep</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">80</span> <span class="k">else</span> <span class="s1">&#39;,&#39;</span>
            <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">as_string</span> <span class="o">=</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_value</span><span class="p">,</span> <span class="n">set_value</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Current option value&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PathOption"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PathOption">[docs]</a><span class="k">class</span> <span class="nc">PathOption</span><span class="p">(</span><span class="n">Option</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Configuration option with `pathlib.Path` value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="PathOption.__init__"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PathOption.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">required</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">Path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arguments:</span>
<span class="sd">            name: Option name.</span>
<span class="sd">            description: Option description. Can span multiple lines.</span>
<span class="sd">            required: True if option must have a value.</span>
<span class="sd">            default: Default option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">Path</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">required</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span></div>
<div class="viewcode-block" id="PathOption.clear"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PathOption.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">to_default</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clears the option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            to_default: If True, sets the option value to default value, else to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="k">if</span> <span class="n">to_default</span> <span class="k">else</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="PathOption.get_formatted"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PathOption.get_formatted">[docs]</a>    <span class="k">def</span> <span class="nf">get_formatted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value formatted for use in config file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;UNDEFINED&gt;&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">)</span></div>
<div class="viewcode-block" id="PathOption.set_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PathOption.set_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">set_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value from string.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="PathOption.get_as_str"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PathOption.get_as_str">[docs]</a>    <span class="k">def</span> <span class="nf">get_as_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns value as string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">)</span></div>
<div class="viewcode-block" id="PathOption.get_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PathOption.get_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns current option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>
<div class="viewcode-block" id="PathOption.set_value"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PathOption.set_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new option value.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            value: New option value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span></div>
<div class="viewcode-block" id="PathOption.load_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PathOption.load_proto">[docs]</a>    <span class="k">def</span> <span class="nf">load_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Deserialize value from `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message that may contains options value.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When the new value is of the wrong type.</span>
<span class="sd">            ValueError: When the argument is not a valid option value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">opt</span><span class="o">.</span><span class="n">HasField</span><span class="p">(</span><span class="s1">&#39;as_string&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_as_str</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">as_string</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrong value type: </span><span class="si">{</span><span class="n">opt</span><span class="o">.</span><span class="n">WhichOneof</span><span class="p">(</span><span class="s1">&#39;kind&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="PathOption.save_proto"><a class="viewcode-back" href="../../../config.html#firebird.base.config.PathOption.save_proto">[docs]</a>    <span class="k">def</span> <span class="nf">save_proto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">:</span> <span class="n">ConfigProto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Serialize value into `.ConfigProto` message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            proto: Protobuf message where option value should be stored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">proto</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">as_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_as_str</span><span class="p">()</span></div>
    <span class="n">value</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_value</span><span class="p">,</span> <span class="n">set_value</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Current option value&quot;</span><span class="p">)</span></div>
</pre></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2020-2022, The Firebird Project.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.2.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>